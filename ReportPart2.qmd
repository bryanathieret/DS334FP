---
title: "Report Part 2"
format:
  html:
    embed-resources: true
    warning: false
    message: false
documentclass: article
author: "Bryana A. S. Thieret"
mainfont: "Cambria"
monofont: "Cambria"
---

## Introduction  


### Data 


### Definitions  







```{r ALL PACKAGES AND DATA}
library(tidyverse)
library(readr)
library(here)
library(haven)
library(emmeans)
library(lmerTest)
library(lme4)
library(plotly)
library(maps)
library(mapproj)
library(usmap)
library(knitr)
library(broom)

twenty022 <- read_xpt(here::here("LLCP2022.XPT ")) ## space after T 
twenty021 <- read_xpt(here::here("LLCP2021.XPT"))
twenty020 <- read_xpt(here::here("LLCP2020.XPT"))
twenty019 <- read_xpt(here::here("LLCP2019.XPT"))

## 2022: 
twenty022 = twenty022 |> select(
                    IYEAR, '_STATE', SEXVAR, MARITAL, VETERAN3, INCOME3, "_BMI5", 
                    EDUCA, RENTHOM1, EMPLOY1, CHILDREN, CAREGIV1, CRGVREL4, CRGVLNG1, CRGVPRB3, SDHEMPLY, FOODSTMP, SDHFOOD1, SDHBILLS, SDHUTILS, SOMALE, TRNSGNDR, RRCLASS3, "_METSTAT", "_URBSTAT", "_IMPRACE", "_AGE_G",
                    GENHLTH, PHYSHLTH, MENTHLTH, POORHLTH, EXERANY2, SLEPTIM1, LASTDEN4, CVDINFR4, CVDCRHD4, CVDSTRK3, ASTHMA3, CHCSCNC1, CHCOCNC1, CHCCOPD3, ADDEPEV3, CHCKDNY2, HAVARTH4, DIABETE4, DEAF, BLIND, DIFFWALK, DIFFDRES, DIFFALON, PREDIAB2,
                      DIABTYPE, CNCRTYP2,  LSATISFY, EMTSUPRT, SDHISOLT, SDHSTRE1, 
                    SMOKE100, SMOKDAY2, USENOW3, ECIGNOW2, LCSFIRST, LCSLAST, LCSNUMCG, LCSSCNCR, ALCDAY4, AVEDRNK3, DRNK3GE5, MAXDRNKS, COPDSMOK, MARIJAN1, MARJSMOK, LASTSMK2, 
                    PRIMINSR, MEDCOST1, 
                    ACEDEPRS, ACEDRINK, ACEDRUGS, ACEPRISN, 
                    ACEDIVRC, ACEPUNCH, ACEHURT1, ACESWEAR,
                    ACETOUCH, ACETTHEM, ACEHVSEX, ACEADSAF, 
                    ACEADNED) |> 
  filter(!is.na(ACEDEPRS) | !is.na(ACEDRINK) | !is.na(ACEDRUGS) | !is.na(ACEPRISN) | 
           !is.na(ACEDIVRC) | !is.na(ACEPUNCH) | !is.na(ACEHURT1) | !is.na(ACESWEAR) | 
           !is.na(ACETOUCH) | !is.na(ACETTHEM) | !is.na(ACEHVSEX) | !is.na(ACEADSAF) |
           !is.na(ACEADNED)) |>
  rename("state" = "_STATE",
         "age" = "_AGE_G",
         "race" = "_IMPRACE",
         "sex" = SEXVAR,
        "MentalIllness" = ACEDEPRS,
         "Alcoholic" = ACEDRINK,
         "SubstanceAddiction" = ACEDRUGS,
         "Incarcerated" = ACEPRISN,
         "SeparationDivorce" = ACEDIVRC,
         "DomesticViolence" = ACEPUNCH,
         "PhysicalAbuse" = ACEHURT1,
         "EmotionalAbuse" = ACESWEAR,
         "SexualAbuse1" = ACETOUCH,
         "SexualAbuse2" = ACETTHEM,
         "SexualAbuse3" = ACEHVSEX,
         "Neglect1" = ACEADSAF,
         "Neglect2" = ACEADNED) |>
mutate(MentalIllness = case_when(
  MentalIllness == 1 ~ 1,
  MentalIllness == 2 ~ 0,
  MentalIllness == 7 ~ NA,
  MentalIllness == 9 ~ NA)) |>
  mutate(Alcoholic = case_when(
    Alcoholic == 1 ~ 1,
    Alcoholic == 2 ~ 0,
    Alcoholic == 7 ~ NA,
    Alcoholic == 9 ~ NA)) |> 
  mutate(SubstanceAddiction = case_when(
    SubstanceAddiction == 1 ~ 1,
    SubstanceAddiction == 2 ~ 0,
    SubstanceAddiction == 7 ~ NA,
    SubstanceAddiction == 9 ~ NA)) |>
  mutate(Incarcerated = case_when(
    Incarcerated == 1 ~ 1,
    Incarcerated == 2 ~ 0,
    Incarcerated == 7 ~ NA,
    Incarcerated == 9 ~ NA)) |> 
  mutate(SeparationDivorce = case_when(
    SeparationDivorce == 1 ~ 1,
    SeparationDivorce == 2 ~ 0,
    SeparationDivorce == 7 ~ NA,
    SeparationDivorce == 8 ~ NA,
    SeparationDivorce == 9 ~ NA)) |>
  mutate(DomesticViolence = case_when(
    DomesticViolence == 1 ~ 0,
    DomesticViolence == 2 ~ 1, 
    DomesticViolence == 3 ~ 1,
    DomesticViolence == 7 ~ NA,
    DomesticViolence == 9 ~ NA)) |>
  mutate(PhysicalAbuse = case_when(
    PhysicalAbuse == 1 ~ 0,
    PhysicalAbuse == 2 ~ 1,
    PhysicalAbuse == 3 ~ 1,
    PhysicalAbuse == 7 ~ NA,
    PhysicalAbuse == 9 ~ NA)) |>
  mutate(EmotionalAbuse = case_when(
    EmotionalAbuse == 1 ~ 0,
    EmotionalAbuse == 2 ~ 1, 
    EmotionalAbuse == 3 ~ 1,
    EmotionalAbuse == 7 ~ NA,
    EmotionalAbuse == 9 ~ NA)) |>
  mutate(SexualAbuse1 = case_when(
    SexualAbuse1 == 1 ~ 0,
    SexualAbuse1 == 2 ~ 1,
    SexualAbuse1 == 3 ~ 1,
    SexualAbuse1 == 7 ~ NA,
    SexualAbuse1 == 9 ~ NA)) |>
  mutate(SexualAbuse2 = case_when(
    SexualAbuse2 == 1 ~ 0,
    SexualAbuse2 == 2 ~ 1,
    SexualAbuse2 == 3 ~ 1,
    SexualAbuse2 == 7 ~ NA,
    SexualAbuse2 == 9 ~ NA)) |> 
  mutate(SexualAbuse3 = case_when(
    SexualAbuse3 == 1 ~ 0,
    SexualAbuse3 == 2 ~ 1,
    SexualAbuse3 == 3 ~ 1,
    SexualAbuse3 == 7 ~ NA,
    SexualAbuse3 == 9 ~ NA)) |>
  mutate(Neglect1 = case_when(
    Neglect1 == NA ~ NA,
    Neglect1 == 1 ~ 0,
    Neglect1 == 2 ~ 1,
    Neglect1 == 3 ~ 1,
    Neglect1 == 4 ~ 1,
    Neglect1 == 5 ~ 1,
    Neglect1 == 7 ~ NA,
    Neglect1 == 9 ~ NA)) |>
  mutate(Neglect2 = case_when(
    Neglect2 == 1 ~ 0,
    Neglect2 == 2 ~ 1,
    Neglect2 == 3 ~ 1,
    Neglect2 == 4 ~ 1,
    Neglect2 == 5 ~ 1,
    Neglect2 == NA ~ NA,
    Neglect2 == 7 ~ NA,
    Neglect2 == 9 ~ NA)) |>
  mutate(number = 1)

## 2021: 
twenty021 = twenty021 |> select(
                    IYEAR, '_STATE', SEXVAR, MARITAL, VETERAN3, INCOME3, "_BMI5",
                    EDUCA, RENTHOM1, EMPLOY1, CHILDREN, CAREGIV1, CRGVREL4, CRGVLNG1, CRGVPRB3, SOMALE, TRNSGNDR, "_METSTAT", "_URBSTAT", "_IMPRACE", "_AGE_G",
                    GENHLTH, PHYSHLTH, MENTHLTH, POORHLTH, EXERANY2, CVDINFR4, CVDCRHD4, CVDSTRK3, ASTHMA3, ADDEPEV3, CHCKDNY2, DIABETE4, DEAF, BLIND, DIFFWALK, DIFFDRES, DIFFALON,
                    SMOKE100, SMOKDAY2, USENOW3, LCSFIRST, LCSLAST, LCSNUMCG, ECIGNOW1, AVEDRNK3, ALCDAY5, DRNK3GE5, MAXDRNKS, MARIJAN1, LASTSMK2, 
                    PRIMINSR, MEDCOST1, 
                    ACEDEPRS, ACEDRINK, ACEDRUGS, ACEPRISN, 
                    ACEDIVRC, ACEPUNCH, ACEHURT1, ACESWEAR,
                    ACETOUCH, ACETTHEM, ACEHVSEX, ACEADSAF, 
                    ACEADNED) |> 
  filter(!is.na(ACEDEPRS) | !is.na(ACEDRINK) | !is.na(ACEDRUGS) | !is.na(ACEPRISN) | 
           !is.na(ACEDIVRC) | !is.na(ACEPUNCH) | !is.na(ACEHURT1) | !is.na(ACESWEAR) | 
           !is.na(ACETOUCH) | !is.na(ACETTHEM) | !is.na(ACEHVSEX) | !is.na(ACEADSAF) |
           !is.na(ACEADNED)) |>
  rename("state" = "_STATE",
         "age" = "_AGE_G",
         "race" = "_IMPRACE",
         "sex" = SEXVAR,
        "MentalIllness" = ACEDEPRS,
         "Alcoholic" = ACEDRINK,
         "SubstanceAddiction" = ACEDRUGS,
         "Incarcerated" = ACEPRISN,
         "SeparationDivorce" = ACEDIVRC,
         "DomesticViolence" = ACEPUNCH,
         "PhysicalAbuse" = ACEHURT1,
         "EmotionalAbuse" = ACESWEAR,
         "SexualAbuse1" = ACETOUCH,
         "SexualAbuse2" = ACETTHEM,
         "SexualAbuse3" = ACEHVSEX,
         "Neglect1" = ACEADSAF,
         "Neglect2" = ACEADNED) |> 
  mutate(MentalIllness = case_when(
  MentalIllness == 1 ~ 1,
  MentalIllness == 2 ~ 0,
  MentalIllness == 7 ~ NA,
  MentalIllness == 9 ~ NA)) |>
  mutate(Alcoholic = case_when(
    Alcoholic == 1 ~ 1,
    Alcoholic == 2 ~ 0,
    Alcoholic == 7 ~ NA,
    Alcoholic == 9 ~ NA)) |> 
  mutate(SubstanceAddiction = case_when(
    SubstanceAddiction == 1 ~ 1,
    SubstanceAddiction == 2 ~ 0,
    SubstanceAddiction == 7 ~ NA,
    SubstanceAddiction == 9 ~ NA)) |>
  mutate(Incarcerated = case_when(
    Incarcerated == 1 ~ 1,
    Incarcerated == 2 ~ 0,
    Incarcerated == 7 ~ NA,
    Incarcerated == 9 ~ NA)) |> 
  mutate(SeparationDivorce = case_when(
    SeparationDivorce == 1 ~ 1,
    SeparationDivorce == 2 ~ 0,
    SeparationDivorce == 7 ~ NA,
    SeparationDivorce == 8 ~ NA,
    SeparationDivorce == 9 ~ NA)) |>
  mutate(DomesticViolence = case_when(
    DomesticViolence == 1 ~ 0,
    DomesticViolence == 2 ~ 1, 
    DomesticViolence == 3 ~ 1,
    DomesticViolence == 7 ~ NA,
    DomesticViolence == 9 ~ NA)) |>
  mutate(PhysicalAbuse = case_when(
    PhysicalAbuse == 1 ~ 0,
    PhysicalAbuse == 2 ~ 1,
    PhysicalAbuse == 3 ~ 1,
    PhysicalAbuse == 7 ~ NA,
    PhysicalAbuse == 9 ~ NA)) |>
  mutate(EmotionalAbuse = case_when(
    EmotionalAbuse == 1 ~ 0,
    EmotionalAbuse == 2 ~ 1, 
    EmotionalAbuse == 3 ~ 1,
    EmotionalAbuse == 7 ~ NA,
    EmotionalAbuse == 9 ~ NA)) |>
  mutate(SexualAbuse1 = case_when(
    SexualAbuse1 == 1 ~ 0,
    SexualAbuse1 == 2 ~ 1,
    SexualAbuse1 == 3 ~ 1,
    SexualAbuse1 == 7 ~ NA,
    SexualAbuse1 == 9 ~ NA)) |>
  mutate(SexualAbuse2 = case_when(
    SexualAbuse2 == 1 ~ 0,
    SexualAbuse2 == 2 ~ 1,
    SexualAbuse2 == 3 ~ 1,
    SexualAbuse2 == 7 ~ NA,
    SexualAbuse2 == 9 ~ NA)) |> 
  mutate(SexualAbuse3 = case_when(
    SexualAbuse3 == 1 ~ 0,
    SexualAbuse3 == 2 ~ 1,
    SexualAbuse3 == 3 ~ 1,
    SexualAbuse3 == 7 ~ NA,
    SexualAbuse3 == 9 ~ NA)) |>
  mutate(Neglect1 = case_when(
    Neglect1 == NA ~ NA,
    Neglect1 == 1 ~ 0,
    Neglect1 == 2 ~ 1,
    Neglect1 == 3 ~ 1,
    Neglect1 == 4 ~ 1,
    Neglect1 == 5 ~ 1,
    Neglect1 == 7 ~ NA,
    Neglect1 == 9 ~ NA)) |>
  mutate(Neglect2 = case_when(
    Neglect2 == 1 ~ 0,
    Neglect2 == 2 ~ 1,
    Neglect2 == 3 ~ 1,
    Neglect2 == 4 ~ 1,
    Neglect2 == 5 ~ 1,
    Neglect2 == NA ~ NA,
    Neglect2 == 7 ~ NA,
    Neglect2 == 9 ~ NA)) |>
  mutate(number = 2)

## 2020: 

twenty020 = twenty020 |> select(
                    IYEAR, '_STATE', SEXVAR, MARITAL, VETERAN3, INCOME2, WEIGHT2, HEIGHT3, 
                    EDUCA, RENTHOM1, EMPLOY1, CHILDREN, CAREGIV1, CRGVREL4, CRGVLNG1, CRGVPRB3, SOMALE, TRNSGNDR, "_METSTAT", "_URBSTAT", "_IMPRACE", "_AGE_G",
                    GENHLTH, PHYSHLTH, MENTHLTH, POORHLTH, EXERANY2, CVDINFR4, CVDCRHD4, CVDSTRK3, ASTHMA3, ADDEPEV3, CHCKDNY2, DIABETE4, DEAF, BLIND, DIFFWALK, DIFFDRES, DIFFALON,
                    SMOKE100, SMOKDAY2, USENOW3, LCSFIRST, LCSLAST, LCSNUMCG, ECIGNOW, AVEDRNK3, ALCDAY5, DRNK3GE5, MAXDRNKS, MARIJAN1, LASTSMK2, 
                    HLTHCVR1,
                    ACEDEPRS, ACEDRINK, ACEDRUGS, ACEPRISN, 
                    ACEDIVRC, ACEPUNCH, ACEHURT1, ACESWEAR,
                    ACETOUCH, ACETTHEM, ACEHVSEX) |> 
  filter(!is.na(ACEDEPRS) | !is.na(ACEDRINK) | !is.na(ACEDRUGS) | !is.na(ACEPRISN) | 
           !is.na(ACEDIVRC) | !is.na(ACEPUNCH) | !is.na(ACEHURT1) | !is.na(ACESWEAR) | 
           !is.na(ACETOUCH) | !is.na(ACETTHEM) | !is.na(ACEHVSEX)) |>
  rename("state" = "_STATE",
         "age" = "_AGE_G",
         "race" = "_IMPRACE",
         "sex" = SEXVAR,
        "MentalIllness" = ACEDEPRS,
         "Alcoholic" = ACEDRINK,
         "SubstanceAddiction" = ACEDRUGS,
         "Incarcerated" = ACEPRISN,
         "SeparationDivorce" = ACEDIVRC,
         "DomesticViolence" = ACEPUNCH,
         "PhysicalAbuse" = ACEHURT1,
         "EmotionalAbuse" = ACESWEAR,
         "SexualAbuse1" = ACETOUCH,
         "SexualAbuse2" = ACETTHEM,
         "SexualAbuse3" = ACEHVSEX) |>
  mutate(MentalIllness = case_when(
  MentalIllness == 1 ~ 1,
  MentalIllness == 2 ~ 0,
  MentalIllness == 7 ~ NA,
  MentalIllness == 9 ~ NA)) |>
  mutate(Alcoholic = case_when(
    Alcoholic == 1 ~ 1,
    Alcoholic == 2 ~ 0,
    Alcoholic == 7 ~ NA,
    Alcoholic == 9 ~ NA)) |> 
  mutate(SubstanceAddiction = case_when(
    SubstanceAddiction == 1 ~ 1,
    SubstanceAddiction == 2 ~ 0,
    SubstanceAddiction == 7 ~ NA,
    SubstanceAddiction == 9 ~ NA)) |>
  mutate(Incarcerated = case_when(
    Incarcerated == 1 ~ 1,
    Incarcerated == 2 ~ 0,
    Incarcerated == 7 ~ NA,
    Incarcerated == 9 ~ NA)) |> 
  mutate(SeparationDivorce = case_when(
    SeparationDivorce == 1 ~ 1,
    SeparationDivorce == 2 ~ 0,
    SeparationDivorce == 7 ~ NA,
    SeparationDivorce == 8 ~ NA,
    SeparationDivorce == 9 ~ NA)) |>
  mutate(DomesticViolence = case_when(
    DomesticViolence == 1 ~ 0,
    DomesticViolence == 2 ~ 1, 
    DomesticViolence == 3 ~ 1,
    DomesticViolence == 7 ~ NA,
    DomesticViolence == 9 ~ NA)) |>
  mutate(PhysicalAbuse = case_when(
    PhysicalAbuse == 1 ~ 0,
    PhysicalAbuse == 2 ~ 1,
    PhysicalAbuse == 3 ~ 1,
    PhysicalAbuse == 7 ~ NA,
    PhysicalAbuse == 9 ~ NA)) |>
  mutate(EmotionalAbuse = case_when(
    EmotionalAbuse == 1 ~ 0,
    EmotionalAbuse == 2 ~ 1, 
    EmotionalAbuse == 3 ~ 1,
    EmotionalAbuse == 7 ~ NA,
    EmotionalAbuse == 9 ~ NA)) |>
  mutate(SexualAbuse1 = case_when(
    SexualAbuse1 == 1 ~ 0,
    SexualAbuse1 == 2 ~ 1,
    SexualAbuse1 == 3 ~ 1,
    SexualAbuse1 == 7 ~ NA,
    SexualAbuse1 == 9 ~ NA)) |>
  mutate(SexualAbuse2 = case_when(
    SexualAbuse2 == 1 ~ 0,
    SexualAbuse2 == 2 ~ 1,
    SexualAbuse2 == 3 ~ 1,
    SexualAbuse2 == 7 ~ NA,
    SexualAbuse2 == 9 ~ NA)) |> 
  mutate(SexualAbuse3 = case_when(
    SexualAbuse3 == 1 ~ 0,
    SexualAbuse3 == 2 ~ 1,
    SexualAbuse3 == 3 ~ 1,
    SexualAbuse3 == 7 ~ NA,
    SexualAbuse3 == 9 ~ NA)) |>
  mutate(number = 3)

# 2019: 

twenty019 = twenty019 |> select(
                    IYEAR, '_STATE', SEXVAR, MARITAL, VETERAN3, INCOME2, WEIGHT2, HEIGHT3, 
                    EDUCA, RENTHOM1, EMPLOY1, CHILDREN, CAREGIV1, CRGVLNG1, CRGVPRB3, SOMALE, TRNSGNDR, "_METSTAT", "_URBSTAT", "_IMPRACE", "_AGE_G",
                    GENHLTH, PHYSHLTH, MENTHLTH, POORHLTH, EXERANY2, CVDINFR4, CVDCRHD4, CVDSTRK3, ASTHMA3, ADDEPEV3, CHCKDNY2, DIABETE4, DEAF, BLIND, DIFFWALK, DIFFDRES, DIFFALON,
                    SMOKE100, SMOKDAY2, USENOW3, LCSFIRST, LCSLAST, LCSNUMCG, ALCDAY5, AVEDRNK3, DRNK3GE5, MAXDRNKS, MARIJAN1, LASTSMK2, 
                    HLTHCVR1,
                    ACEDEPRS, ACEDRINK, ACEDRUGS, ACEPRISN, 
                    ACEDIVRC, ACEPUNCH, ACEHURT1, ACESWEAR,
                    ACETOUCH, ACETTHEM, ACEHVSEX) |> 
  filter(!is.na(ACEDEPRS) | !is.na(ACEDRINK) | !is.na(ACEDRUGS) | !is.na(ACEPRISN) | 
           !is.na(ACEDIVRC) | !is.na(ACEPUNCH) | !is.na(ACEHURT1) | !is.na(ACESWEAR) | 
           !is.na(ACETOUCH) | !is.na(ACETTHEM) | !is.na(ACEHVSEX)) |>
  rename("state" = "_STATE",
         "age" = "_AGE_G",
         "race" = "_IMPRACE",
         "sex" = SEXVAR,
        "MentalIllness" = ACEDEPRS,
         "Alcoholic" = ACEDRINK,
         "SubstanceAddiction" = ACEDRUGS,
         "Incarcerated" = ACEPRISN,
         "SeparationDivorce" = ACEDIVRC,
         "DomesticViolence" = ACEPUNCH,
         "PhysicalAbuse" = ACEHURT1,
         "EmotionalAbuse" = ACESWEAR,
         "SexualAbuse1" = ACETOUCH,
         "SexualAbuse2" = ACETTHEM,
         "SexualAbuse3" = ACEHVSEX) |>
  mutate(MentalIllness = case_when(
  MentalIllness == 1 ~ 1,
  MentalIllness == 2 ~ 0,
  MentalIllness == 7 ~ NA,
  MentalIllness == 9 ~ NA)) |>
  mutate(Alcoholic = case_when(
    Alcoholic == 1 ~ 1,
    Alcoholic == 2 ~ 0,
    Alcoholic == 7 ~ NA,
    Alcoholic == 9 ~ NA)) |> 
  mutate(SubstanceAddiction = case_when(
    SubstanceAddiction == 1 ~ 1,
    SubstanceAddiction == 2 ~ 0,
    SubstanceAddiction == 7 ~ NA,
    SubstanceAddiction == 9 ~ NA)) |>
  mutate(Incarcerated = case_when(
    Incarcerated == 1 ~ 1,
    Incarcerated == 2 ~ 0,
    Incarcerated == 7 ~ NA,
    Incarcerated == 9 ~ NA)) |> 
  mutate(SeparationDivorce = case_when(
    SeparationDivorce == 1 ~ 1,
    SeparationDivorce == 2 ~ 0,
    SeparationDivorce == 7 ~ NA,
    SeparationDivorce == 8 ~ NA,
    SeparationDivorce == 9 ~ NA)) |>
  mutate(DomesticViolence = case_when(
    DomesticViolence == 1 ~ 0,
    DomesticViolence == 2 ~ 1, 
    DomesticViolence == 3 ~ 1,
    DomesticViolence == 7 ~ NA,
    DomesticViolence == 9 ~ NA)) |>
  mutate(PhysicalAbuse = case_when(
    PhysicalAbuse == 1 ~ 0,
    PhysicalAbuse == 2 ~ 1,
    PhysicalAbuse == 3 ~ 1,
    PhysicalAbuse == 7 ~ NA,
    PhysicalAbuse == 9 ~ NA)) |>
  mutate(EmotionalAbuse = case_when(
    EmotionalAbuse == 1 ~ 0,
    EmotionalAbuse == 2 ~ 1, 
    EmotionalAbuse == 3 ~ 1,
    EmotionalAbuse == 7 ~ NA,
    EmotionalAbuse == 9 ~ NA)) |>
  mutate(SexualAbuse1 = case_when(
    SexualAbuse1 == 1 ~ 0,
    SexualAbuse1 == 2 ~ 1,
    SexualAbuse1 == 3 ~ 1,
    SexualAbuse1 == 7 ~ NA,
    SexualAbuse1 == 9 ~ NA)) |>
  mutate(SexualAbuse2 = case_when(
    SexualAbuse2 == 1 ~ 0,
    SexualAbuse2 == 2 ~ 1,
    SexualAbuse2 == 3 ~ 1,
    SexualAbuse2 == 7 ~ NA,
    SexualAbuse2 == 9 ~ NA)) |> 
  mutate(SexualAbuse3 = case_when(
    SexualAbuse3 == 1 ~ 0,
    SexualAbuse3 == 2 ~ 1,
    SexualAbuse3 == 3 ~ 1,
    SexualAbuse3 == 7 ~ NA,
    SexualAbuse3 == 9 ~ NA)) |>
  mutate(number = 4)

## Dataset that inclueds everything: 
everything = full_join(twenty019, full_join(twenty020, full_join(twenty021, twenty022)))

```


## Data Population  
It is important to understand the demographics of those who make up our data set in order to generalize the findings to a larger population. To do this we will look at data collected by year, state, age, sex, and race.  


### Surveys by Year  

The complete data set consists of 343,813 observations between 2019 and 2023. The year 2020 made up the largest proportion of observations ($p$ = 0.3795) followed by 2019 ($p$ = 0.2984), 2021 ($p$ = 0.1711), 2022 ($p$ = 0.1466), and, lastly 2023 ($p$ = 0.0044).  


```{r}
everything |> mutate(IYEAR = as.factor(IYEAR)) |>
  group_by(IYEAR) |>
  summarise(n_Surveys = n(),
            prop = n()/343813) |>
  rename("year" = IYEAR) |>
  kable()


year = everything |> mutate(IYEAR = as.factor(IYEAR)) |>
  group_by(IYEAR, sex) |>
  summarise(Surveys = n(),
            prop = n()/343813) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  ggplot(aes(x = IYEAR, y = prop, label = Surveys, fill = sex)) +
  geom_col() +
  coord_flip() +
  labs(y = "Proportion of Surveys", x = "Year") +
  theme_minimal() +
  scale_fill_brewer(palette = "Pastel1", direction = -1) +
  theme(
    axis.title = element_text(color = "black", family = "Avenir", size = 22),
    axis.text = element_text(color = "black", family = "Avenir", size = 18),
    legend.title = element_text(color = "white"),
    legend.text = element_text(color = "black", size = 13, family = "Avenir"),
    legend.position = "top"
  )
ggplotly(year, tooltip = "label")
```

## Surveys by State  


```{r}
library(maps)
library(ggmaps)
state_df <- ggplot2::map_data("state")
ggplot2::map_data()

maps::usa()

states = tibble(state.name = state.name) |> mutate(number = c(1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49, 50, 51, 53, 54, 55, 56))
otherstates = tibble(state.name = c("District of Columbia", "Guam", "Puerto Rico", "Virgin Islands"),
       number = c(11, 66, 72, 78))
states = full_join(states, otherstates)

ace_state = left_join(everything, states, by = c("state" = "number")) 
ace_state = ace_state |> group_by(state.name) |> 
  summarise(n = n()) |>
  mutate(state.name = str_to_lower(state.name)) |>
  rename("state" = "state.name", 
         "Surveys" = n)


 states = plot_usmap(data = ace_state, values = "Surveys") +
  theme_void() +
  scale_fill_distiller(palette = "PuRd", direction = 1, na.value = "black") + 
  labs(caption = "States that are black represent NA.", title = "Surveys by State") +
  theme(
    legend.text = element_text(color = "black", family = "Avenir", size = 15),
    legend.title = element_blank(),
    legend.key.width = unit(3, "line"),
    title = element_text(color = "black", family = "Avenir", size = 10),
    legend.position = c(0.55, 0.98),
    legend.direction = "horizontal",
    plot.title = element_text(color = "black", family = "Avenir", size = 16),
    plot.caption = element_text(color = "black", family = "Avenir", size = 11))

 
ggplotly(states)
```

## Surveys by Race  


```{r}

everything |>
  mutate(race = case_when(
    race == 1 ~ "White",
    race == 2 ~ "Black",
    race == 3 ~ "Asian",
    race == 4 ~ "AI/AN",
    race == 5 ~ "Hispanic",
    race == 6 ~ "Other"
  )) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  group_by(race, sex) |>
  summarise(Surveys = n(),
            prop = n()/343813) |>
  mutate(race = as.factor(race)) |>
  mutate(race = fct_relevel(race, c("Asian", "AI/AN", "Other", "Hispanic", "Black", "White"))) |>
  ggplot(aes(x = prop, y = race, fill = sex)) +
  geom_col() +
  theme_minimal() +
  labs(x = "Proportion", caption = "AI/AN = American Indian/Alaskan Native") +
  scale_fill_brewer(palette = "Pastel1", direction = -1) +
  theme(
    axis.title.y = element_blank(),
    axis.title.x = element_text(color = "black", size = 22, family = "Avenir"),
    axis.text.x = element_text(color = "black", size = 18, family = "Avenir"),
    axis.text.y = element_text(color = "black", size = 14, family = "Avenir"),
    legend.position = "top",
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    plot.caption = element_text(color = "black", size = 10, family = "Avenir")
  )


```



```{r}
everything |> 
  mutate(age = case_when(
    age == 1 ~ "18 to 24",
    age == 2 ~ "25 to 34",
    age == 3 ~ "35 to 44",
    age == 4 ~ "45 to 54",
    age == 5 ~ "55 to 64",
    age == 6 ~ "65 or > 65"
  )) |> 
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  group_by(age, sex) |>
  summarise(Surveys = n(),
            prop = n()/343813) |>
  ggplot(aes(x = prop, y = age, fill = sex)) +
  geom_col() +
  theme_minimal() +
  labs(x = "Proportion") +
  scale_fill_brewer(palette = "Pastel1", direction = -1) +
  theme(
    axis.title.y = element_blank(),
    axis.title.x = element_text(color = "black", size = 22, family = "Avenir"),
    axis.text.x = element_text(color = "black", size = 18, family = "Avenir"),
    axis.text.y = element_text(color = "black", size = 14, family = "Avenir"),
    legend.position = "top",
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    plot.caption = element_text(color = "black", size = 10, family = "Avenir")
  )
```


## Proportion with a History of Adverse Childhood Event Experience(s)  


```{r}
everything |> select(MentalIllness, Alcoholic, Incarcerated, SeparationDivorce, DomesticViolence, PhysicalAbuse, EmotionalAbuse, SexualAbuse1, SexualAbuse2, SexualAbuse3, Neglect1, Neglect2, SubstanceAddiction) |>
  summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE)/343813,
            Alcoholic = sum(Alcoholic, na.rm = TRUE)/343813,
            SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE)/343813,
            Incarcerated = sum(Incarcerated, na.rm = TRUE)/343813,
            SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE)/343813,
            DomesticViolence = sum(DomesticViolence, na.rm = TRUE)/343813,
            PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE)/343813,
            EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE)/343813,
            SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE)/343813,
            SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE)/343813,
            SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE)/343813,
            Neglect1 = sum(Neglect1, na.rm = TRUE)/104253,
            Neglect2 = sum(Neglect2, na.rm = TRUE)/104253) |>
  pivot_longer(c(1:13), names_to = "Category", values_to = "n") |>
  mutate(Category = fct_reorder(Category, n)) |>
  ggplot(aes(x = n, y = Category)) + 
  geom_col()
  

everything |> select(MentalIllness, Alcoholic, Incarcerated, SeparationDivorce, DomesticViolence, PhysicalAbuse, EmotionalAbuse, SexualAbuse1, SexualAbuse2, SexualAbuse3, Neglect1, Neglect2, SubstanceAddiction, sex) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  group_by(sex) |>
  summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE)/343813,
            Alcoholic = sum(Alcoholic, na.rm = TRUE)/343813,
            SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE)/343813,
            Incarcerated = sum(Incarcerated, na.rm = TRUE)/343813,
            SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE)/343813,
            DomesticViolence = sum(DomesticViolence, na.rm = TRUE)/343813,
            PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE)/343813,
            EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE)/343813,
            SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE)/343813,
            SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE)/343813,
            SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE)/343813,
            Neglect1 = sum(Neglect1, na.rm = TRUE)/104253,
            Neglect2 = sum(Neglect2, na.rm = TRUE)/104253) |>
  pivot_longer(c(2:14), names_to = "Category", values_to = "prop") |>
  mutate(Category = fct_reorder(Category, prop)) |>
  ggplot(aes(x = prop, y = Category, fill = sex)) + 
  scale_fill_brewer(palette = "Pastel1", direction = -1) +
  geom_col(position = position_dodge(0.9)) +
  theme_minimal() +
  labs(x = "Proportion of People") +
  theme(
    legend.position = "top",
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 14, family = "Avenir"),
    axis.title.y = element_blank(),
    axis.title.x = element_text(color = "black", size = 18, family = "Avenir"),
    axis.text.x = element_text(color = "black", size = 15, family = "Avenir"),
    axis.text.y = element_text(color = "black", size = 15, family = "Avenir"),
  )





everything |> 
  select(Neglect1, Neglect2) |> 
  filter(!is.na(Neglect1) | !is.na(Neglect2))


everything |> 
  mutate(age = case_when(
    age == 1 ~ "18 to 24",
    age == 2 ~ "25 to 34",
    age == 3 ~ "35 to 44",
    age == 4 ~ "45 to 54",
    age == 5 ~ "55 to 64",
    age == 6 ~ "65 or > 65"
  )) |> 
  mutate(race = case_when(
    race == 1 ~ "White",
    race == 2 ~ "Black",
    race == 3 ~ "Asian",
    race == 4 ~ "AI/AN",
    race == 5 ~ "Hispanic",
    race == 6 ~ "Other"
  )) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  group_by(age, sex) |>
            summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE),
            Alcoholic = sum(Alcoholic, na.rm = TRUE),
            SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE),
            Incarcerated = sum(Incarcerated, na.rm = TRUE),
            SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE),
            DomesticViolence = sum(DomesticViolence, na.rm = TRUE),
            PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE),
            EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE),
            SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE),
            SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE),
            SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE),
            Neglect1 = sum(Neglect1, na.rm = TRUE),
            Neglect2 = sum(Neglect2, na.rm = TRUE)) |>
  pivot_longer(c(3:15), names_to = "Category", values_to = "n") |>
  ggplot(aes(x = n, y = age, fill = sex)) +
  geom_col(position = position_dodge(0.9)) +
  facet_wrap(~Category, ncol = 4) +
  theme_minimal() +
  scale_fill_brewer(palette = "Pastel1", direction = -1) +
  labs(x = "Number of People") +
  theme(
    axis.title.y = element_blank(),
    axis.title.x = element_text(color = "black", size = 22, family = "Avenir"),
    axis.text.x = element_text(color = "black", size = 10, family = "Avenir"),
    axis.text.y = element_text(color = "black", size = 14, family = "Avenir"),
    legend.position = "top",
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    plot.caption = element_text(color = "black", size = 10, family = "Avenir"),
    strip.text = element_text(color = "black", size = 12, family = "Avenir")
    
  ) 
```


# Addiction and ACEs  


## Have you smoked at least 100 cigarettes in your entire life?  

### Prior Information:  
This question was answered by 99.37% of the previously established population.   

### Model:  

Quasibinomial regressions were compared through chi-square tests to evaluate which model was a significantly better fit which is based on null and residual deviance. Quasibinomial was used instead of binomial to avoid overfitting. The dispersion parameter for the best model was 1.0012. 


```{=tex, model equation for SMOKE100}
\begin{align*}
log(\frac{\pi_i}{1 - \pi_i}) = \\
  &\beta_1 (\text{sex}) + \\
  &\beta_2 (\text{age}) + \\
  &\beta_3 (\text{MentalIllness}) + \beta_4 (\text{MentalIllness} \cdot \text{sex}) + \beta_5 (\text{MentalIllness} \cdot \text{age}) + \beta_6 (\text{MentalIllness} \cdot \text{sex} \cdot \text{age}) + \\
  &\beta_7 (\text{Alcohol}) + \beta_8 (\text{Alcohol} \cdot \text{sex}) + \beta_9 (\text{Alcohol} \cdot \text{age}) + \beta_{10} (\text{Alcohol} \cdot \text{sex} \cdot \text{age}) + \\
  &\beta_{11} (\text{SubstanceAddiction}) + \beta_{12} (\text{SubstanceAddiction} \cdot \text{sex}) + \beta_{13} (\text{SubstanceAddiction} \cdot \text{age}) + \beta_{14} (\text{SubstanceAddiction} \cdot \text{sex} \cdot \text{age}) + \\
  &\beta_{15} (\text{Incarcerated}) + \beta_{16} (\text{Incarcerated} \cdot \text{sex}) + \beta_{17} (\text{Incarcerated} \cdot \text{age}) + \beta_{18} (\text{Incarcerated} \cdot \text{sex} \cdot \text{age}) + \\
                  &\beta_{19} (\text{SeparationDivorce}) + \beta_{20} (\text{SeparationDivorce} \cdot \text{age}) + \beta_{21} (\text{SeparationDivorce} \cdot \text{sex}) + \beta_{22} (\text{SeparationDivorce} \cdot \text{age} \cdot \text{sex}) + \\
                  &\beta_{23} (\text{DomesticViolence}) + \beta_{24} (\text{DomesticViolence} \cdot \text{age}) + \beta_{25} (\text{DomesticViolence} \cdot \text{sex}) + \beta_{26} (\text{DomesticViolence} \cdot \text{age} \cdot \text{sex}) + \\
                  &\beta_{27} (\text{PhysicalAbuse}) + \beta_{28} (\text{PhysicalAbuse} \cdot \text{age}) + \beta_{29} (\text{PhysicalAbuse} \cdot \text{sex}) + \beta_{30} (\text{PhysicalAbuse} \cdot \text{age} \cdot \text{sex}) + \\
                  &\beta_{31} (\text{EmotionalAbuse}) + \beta_{32} (\text{EmotionalAbuse} \cdot \text{age}) + \beta_{33} (\text{EmotionalAbuse} \cdot \text{sex}) + \beta_{34} (\text{EmotionalAbuse} \cdot \text{age} \cdot \text{sex}) + \\
                  &\beta_{35} (\text{SexualAbuse1}) + \beta_{36} (\text{SexualAbuse1} \cdot \text{age}) + \beta_{37} (\text{SexualAbuse1} \cdot \text{sex}) + \beta_{38} (\text{SexualAbuse1} \cdot \text{age} \cdot \text{sex}) + \\
                  &\beta_{39} (\text{SexualAbuse2}) + \beta_{40} (\text{SexualAbuse2} \cdot \text{age}) + \beta_{41} (\text{SexualAbuse2} \cdot \text{sex}) + \beta_{42} (\text{SexualAbuse2} \cdot \text{age} \cdot \text{sex}) + \\
                  &\beta_{43} (\text{SexualAbuse3}) + \beta_{44} (\text{SexualAbuse3} \cdot \text{age}) + \beta_{45} (\text{SexualAbuse3} \cdot \text{sex}) + \beta_{46} (\text{SexualAbuse3} \cdot \text{age} \cdot \text{sex}) + \\
                  &\beta_{47} (\text{Neglect1}) + \beta_{48} (\text{Neglect1} \cdot \text{age}) + \beta_{49} (\text{Neglect1} \cdot \text{sex}) + \beta_{50} (\text{Neglect1} \cdot \text{age} \cdot \text{sex}) + \\
                  &\beta_{51} (\text{Neglect2}) + \beta_{52} (\text{Neglect2} \cdot \text{age}) + \beta_{53} (\text{Neglect2} \cdot \text{sex}) + \beta_{54} (\text{Neglect2} \cdot \text{age} \cdot \text{sex}) + \\
\end{align*}
```




```{r}
smoke100 = everything |> select(MentalIllness, Alcoholic, Incarcerated, SeparationDivorce, DomesticViolence, PhysicalAbuse, EmotionalAbuse, SexualAbuse1, SexualAbuse2, SexualAbuse3, Neglect1, Neglect2, SubstanceAddiction, SMOKE100, sex, age, race) |>
  mutate(SMOKE100 = case_when(
    SMOKE100 == 1 ~ 1,
    SMOKE100 == 2 ~ 0,
    SMOKE100 == 7 ~ NA,
    SMOKE100 == 9 ~ NA)) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  mutate(sex = as.factor(sex),
         age = as.factor(age),
         race = as.factor(race),
         MentalIllness = as.factor(MentalIllness),
         Alcoholic = as.factor(Alcoholic),
         Incarcerated = as.factor(Incarcerated),
         SeparationDivorce = as.factor(SeparationDivorce),
         DomesticViolence = as.factor(DomesticViolence),
         PhysicalAbuse = as.factor(PhysicalAbuse),
         EmotionalAbuse = as.factor(EmotionalAbuse),
         SexualAbuse1 = as.factor(SexualAbuse1),
         SexualAbuse2 = as.factor(SexualAbuse2),
         SexualAbuse3 = as.factor(SexualAbuse3),
         Neglect1 = as.factor(Neglect1),
         Neglect2 = as.factor(Neglect2),
         SubstanceAddiction = as.factor(SubstanceAddiction))

smoke100 = smoke100 |> filter(!is.na(SMOKE100)) 


smoke100all4 = glm(SMOKE100 ~
                    MentalIllness + MentalIllness*sex + MentalIllness*age + MentalIllness*age*sex + 
                    Alcoholic + Alcoholic*sex + Alcoholic*age + Alcoholic*age*sex + 
                    SubstanceAddiction + SubstanceAddiction*sex + SubstanceAddiction*age + SubstanceAddiction*age*sex + 
                    Incarcerated + Incarcerated*sex + Incarcerated*age + Incarcerated*age*sex + 
                    SeparationDivorce + SeparationDivorce*sex + SeparationDivorce*age + SeparationDivorce*age*sex + 
                    DomesticViolence + DomesticViolence*sex + DomesticViolence*age + DomesticViolence*age*sex + 
                    PhysicalAbuse + PhysicalAbuse*sex  + PhysicalAbuse*age + PhysicalAbuse*age*sex + 
                    EmotionalAbuse + EmotionalAbuse*sex + EmotionalAbuse*age + EmotionalAbuse*age*sex + 
                    SexualAbuse1 + SexualAbuse1*sex + SexualAbuse1*age + SexualAbuse1*age*sex + 
                    SexualAbuse2 + SexualAbuse2*sex + SexualAbuse2*age + SexualAbuse2*age*sex + 
                    SexualAbuse3 + SexualAbuse3*sex + SexualAbuse3*age + SexualAbuse3*age*sex + 
                    Neglect1 + Neglect1*sex + Neglect1*age + Neglect1*age*sex + 
                    Neglect2 + Neglect2*sex + Neglect2*age + Neglect2*age*sex, 
                  family = "quasibinomial", data = smoke100)
#summary(smoke100all4)

tidy(smoke100all4) |> 
    #filter(p.value <= 0.05) |>
    mutate(estimate = exp(estimate)) |> kable()


```


### Results:  

Those who do not report a history of any ACE, that are female, and are between the ages 18-24 have a 0.0253 times lower odds of reporting having smoked at least 100 cigarettes compared to those who have reported any ACE, are female, and that are older than 24 ($\beta_0 = 0.0253$, $t = -4.554$, $p < .00001$).   

On average, males report a 11.190 times greater odds of having smoked at least 100 cigarettes compared to females that have not reported any ACE and that are between the ages of 18-24 ($t = 2.667$, $p = .008$).  


Males that report no ACE are 

On average, those who report a history of mental illness in the household have a 1.724 times greater odds of reporting having smoked at least 100 cigarettes ($t = 3.056$, $p = .002$).  



```{r}
smoke100 |> 
   mutate(age = case_when(
    age == 1 ~ "18 to 24",
    age == 2 ~ "25 to 34",
    age == 3 ~ "35 to 44",
    age == 4 ~ "45 to 54",
    age == 5 ~ "55 to 64",
    age == 6 ~ "65 or > 65"
  )) |> 
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  group_by(sex, age) |> 
  summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE),
            Alcoholic = sum(Alcoholic, na.rm = TRUE),
            SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE),
            Incarcerated = sum(Incarcerated, na.rm = TRUE),
            SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE),
            DomesticViolence = sum(DomesticViolence, na.rm = TRUE),
            PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE),
            EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE),
            SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE),
            SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE),
            SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE),
            Neglect1 = sum(Neglect1, na.rm = TRUE),
            Neglect2 = sum(Neglect2, na.rm = TRUE)) |> 
  pivot_longer(c(3:15), names_to = "category", values_to = "n") |>
  mutate(sex = as.factor(sex)) |>
  ggplot(aes(x = category, y = n, col = sex)) +
  geom_point(shape = 21, stroke = 1) +
  facet_wrap(~age) + 
  coord_flip() +
  theme_minimal() +
  scale_color_brewer(palette = "Pastel1", direction = -1) +
  theme(
    legend.position = "top",
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 14, family = "Avenir"),
    axis.title.y = element_blank(),
    axis.text.y = element_text(color = "black", size = 15, family = "Avenir"),
    axis.title.x = element_text(color = "black", size = 20, family = "Avenir"),
    axis.text.x = element_text(color = "black", size = 16, family = "Avenir"), 
    strip.text = element_text(color = "black", size = 14, family = "Avenir")
  ) 
```








## Do you now smoke cigarettes every day, some days, or not at all?  

I recategorized this question so it was binary by combining responses that were some days and every day as the same (1) while not at all was categorized as the opposite (0).  

### Prior Information:  


### Model:  

```{=tex}
\begin{align*}
log(\frac{1-p}{p}) = &\beta_1 (\text{sex}) + \\
                     &\beta_2 (\text{age}) + \\
                     &\beta_3 (\text{MentalIllness}) + \beta_4 (\text{MentalIllness} \cdot \text{age}) + \beta_5 (\text{MentalIllness} \cdot \text{sex}) + \\
                     &\beta_6 (\text{Alcohol}) + \beta_7 (\text{Alcohol} \cdot \text{age}) + \beta_8 (\text{Alcohol} \cdot \text{sex}) + \\
                     &\beta_9 (\text{SubstanceAddiction}) + \beta_{10} (\text{SubstanceAddiction} \cdot \text{age}) + \beta_{11} (\text{SubstanceAddiction} \cdot \text{sex}) + \\
                     &\beta_{12} (\text{Incarcerated}) + \beta_{13} (\text{Incarcerated} \cdot \text{age}) + \beta_{14} (\text{Incarcerated} \cdot \text{sex}) + \\
                     &\beta_{15} (\text{SeparationDivorce}) + \beta_{16} (\text{SeparationDivorce} \cdot \text{age}) + \beta_{17} (\text{SeparationDivorce} \cdot \text{sex}) + \\
                     &\beta_{18} (\text{DomesticViolence}) + \beta_{19} (\text{DomesticViolence} \cdot \text{age}) + \beta_{20} (\text{DomesticViolence} \cdot \text{sex}) + \\
                     &\beta_{21} (\text{PhysicalAbuse}) + \beta_{22} (\text{PhysicalAbuse} \cdot \text{age}) + \beta_{23} (\text{PhysicalAbuse} \cdot \text{sex}) + \\
                     &\beta_{24} (\text{EmotionalAbuse}) + \beta_{25} (\text{EmotionalAbuse} \cdot \text{age}) + \beta_{26} (\text{EmotionalAbuse} \cdot \text{sex}) + \\
                     &\beta_{27} (\text{SexualAbuse1}) + \beta_{28} (\text{SexualAbuse1} \cdot \text{age}) + \beta_{29} (text{SexualAbuse1} \cdot \text{sex}) + \\
                     &\beta_{30} (\text{SexualAbuse2}) + \beta_{31} (\text{SexualAbuse2} \cdot \text{age}) + \beta_{32} (\text{SexualAbuse2} \cdot \text{sex}) + \\
                     &\beta_{33} (\text{SexualAbuse3}) + \beta_{34} (\text{SexualAbuse3} \cdot \text{age}) + \beta_{35} (\text{SexualAbuse3} \cdot \text{sex}) + \\
                     &\beta_{36} (\text{Neglect1}) + \beta_{37} (\text{Neglect1} \cdot \text{age}) + \beta_{38} (\text{Neglect1} \cdot \text{sex}) + \\ 
                     &\beta_{39} (\text{Neglect2}) + \beta_{40} (\text{Neglect2} \cdot \text{age}) + \beta_{41} (\text{Neglect2} \cdot \text{sex}) \\
\end{align*}
```







```{r}
smokdays2 = everything |> select(MentalIllness, Alcoholic, Incarcerated, SeparationDivorce, DomesticViolence, PhysicalAbuse, EmotionalAbuse, SexualAbuse1, SexualAbuse2, SexualAbuse3, Neglect1, Neglect2, SubstanceAddiction, SMOKDAY2, sex, age, race) |>
  mutate(SMOKDAY2 = case_when(
    SMOKDAY2 == 1 ~ 1,
    SMOKDAY2 == 2 ~ 1,
    SMOKDAY2 == 3 ~ 0,
    SMOKDAY2 == 7 ~ NA,
    SMOKDAY2 == 9 ~ NA,
    SMOKDAY2 == NA ~ NA
  )) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  mutate(sex = as.factor(sex),
         age = as.factor(age),
         race = as.factor(race),
         MentalIllness = as.factor(MentalIllness),
         Alcoholic = as.factor(Alcoholic),
         Incarcerated = as.factor(Incarcerated),
         SeparationDivorce = as.factor(SeparationDivorce),
         DomesticViolence = as.factor(DomesticViolence),
         PhysicalAbuse = as.factor(PhysicalAbuse),
         EmotionalAbuse = as.factor(EmotionalAbuse),
         SexualAbuse1 = as.factor(SexualAbuse1),
         SexualAbuse2 = as.factor(SexualAbuse2),
         SexualAbuse3 = as.factor(SexualAbuse3),
         Neglect1 = as.factor(Neglect1),
         Neglect2 = as.factor(Neglect2),
         SubstanceAddiction = as.factor(SubstanceAddiction)) |>
  filter(!is.na(SMOKDAY2)) 

smokdays2all3 = glm(SMOKDAY2 ~ 
                    MentalIllness + MentalIllness*sex + MentalIllness*age + 
                    Alcoholic + Alcoholic*sex + Alcoholic*age + 
                    SubstanceAddiction + SubstanceAddiction*sex + SubstanceAddiction*age + 
                    Incarcerated + Incarcerated*sex + Incarcerated*age + 
                    SeparationDivorce + SeparationDivorce*sex + SeparationDivorce*age + 
                    DomesticViolence + DomesticViolence*sex + DomesticViolence*age + 
                    PhysicalAbuse + PhysicalAbuse*sex  + PhysicalAbuse*age + 
                    EmotionalAbuse + EmotionalAbuse*sex + EmotionalAbuse*age + 
                    SexualAbuse1 + SexualAbuse1*sex + SexualAbuse1*age + 
                    SexualAbuse2 + SexualAbuse2*sex + SexualAbuse2*age + 
                    SexualAbuse3 + SexualAbuse3*sex + SexualAbuse3*age + 
                    Neglect1 + Neglect1*sex + Neglect1*age + 
                    Neglect2 + Neglect2*sex + Neglect2*age, 
                  family = "quasibinomial", data = smokdays2)
summary(smokdays2all3)

tidy(smokdays2all3) |> 
  #filter(p.value <= 0.05)
  mutate(estimate = exp(estimate)) |>
  kable()
```



### Results  



## During the past 30 days, how many days per week or per month did you have at least one drink of any alcoholic bevarage?  


### Prior Information:  


### Model: 







```{r}
# ALCDAY4 ~ 1
## During the past 30 days, how many days per week or per month did you have at least one drink of any alcoholic
### Coded: perweek ~ days per week out of 7, permonth ~ days per month out of 30
# ALCDAY5 ~ 2/3/4
## Question: During the past 30 days, how many days per week or per month did you have at least one drink of any alcoholic beverage such as beer, wine, a malt beverage or liquor?
### Coded: perweek ~ days per week out of 7, permonth ~ days per month out of 30

perweek = everything |> select(MentalIllness, Alcoholic, Incarcerated, SeparationDivorce, DomesticViolence, PhysicalAbuse, EmotionalAbuse, SexualAbuse1, SexualAbuse2, SexualAbuse3, Neglect1, Neglect2, SubstanceAddiction, ALCDAY4, ALCDAY5, sex, age, race, number) |>
  mutate(perweek = case_when(
    ALCDAY5 == 101 ~ 1,
    ALCDAY5 == 102 ~ 2, 
    ALCDAY5 == 103 ~ 3,
    ALCDAY5 == 104 ~ 4, 
    ALCDAY5 == 105 ~ 5,
    ALCDAY5 == 106 ~ 6,
    ALCDAY5 == 107 ~ 7,
    ALCDAY4 == 101 ~ 1,
    ALCDAY4 == 102 ~ 2,
    ALCDAY4 == 103 ~ 3,
    ALCDAY4 == 104 ~ 4,
    ALCDAY4 == 105 ~ 5,
    ALCDAY4 == 106 ~ 6,
    ALCDAY4 == 107 ~ 7)) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  mutate(sex = as.factor(sex),
         age = as.factor(age),
         race = as.factor(race),
         MentalIllness = as.factor(MentalIllness),
         Alcoholic = as.factor(Alcoholic),
         Incarcerated = as.factor(Incarcerated),
         SeparationDivorce = as.factor(SeparationDivorce),
         DomesticViolence = as.factor(DomesticViolence),
         PhysicalAbuse = as.factor(PhysicalAbuse),
         EmotionalAbuse = as.factor(EmotionalAbuse),
         SexualAbuse1 = as.factor(SexualAbuse1),
         SexualAbuse2 = as.factor(SexualAbuse2),
         SexualAbuse3 = as.factor(SexualAbuse3),
         Neglect1 = as.factor(Neglect1),
         Neglect2 = as.factor(Neglect2),
         SubstanceAddiction = as.factor(SubstanceAddiction)) |>
  filter(!is.na(perweek)) 

perweek |> ggplot(aes(x = perweek)) + geom_histogram(stat = "count")


perweekall1 = glm(perweek ~ age + sex + race +
                    MentalIllness + 
                    Alcoholic + 
                    SubstanceAddiction + 
                    Incarcerated + 
                    SeparationDivorce + 
                    DomesticViolence +
                    PhysicalAbuse + 
                    EmotionalAbuse + 
                    SexualAbuse1 + 
                    SexualAbuse2 + 
                    SexualAbuse3 + 
                    Neglect1 + 
                    Neglect2, 
                  family = "quasipoisson", data = perweek)
summary(perweekall1)
    
tidy(perweekall1) |> 
  mutate(estimate = exp(estimate)) |>
  filter(p.value <= 0.05) |>
  kable()


```

mutate(age = case_when(
    age == 1 ~ "18 to 24",
    age == 2 ~ "25 to 34",
    age == 3 ~ "35 to 44",
    age == 4 ~ "45 to 54",
    age == 5 ~ "55 to 64",
    age == 6 ~ "65 or > 65"
  ))

mutate(race = case_when(
    race == 1 ~ "White",
    race == 2 ~ "Black",
    race == 3 ~ "Asian",
    race == 4 ~ "AI/AN",
    race == 5 ~ "Hispanic",
    race == 6 ~ "Other"
  ))
### Results  

Those who report no ACE, between the ages of 18-24, are white, and are female drink on average 2.12 more days compared to those who report an ACE, above the age of 24, are a different race then white, and are male. 




```{r}
everything |> select(MentalIllness, Alcoholic, Incarcerated, SeparationDivorce, DomesticViolence, PhysicalAbuse, EmotionalAbuse, SexualAbuse1, SexualAbuse2, SexualAbuse3, Neglect1, Neglect2, SubstanceAddiction, ALCDAY4, ALCDAY5, sex, age, race, number) |>
  mutate(perweek = case_when(
    ALCDAY5 == 101 ~ 1,
    ALCDAY5 == 102 ~ 2, 
    ALCDAY5 == 103 ~ 3,
    ALCDAY5 == 104 ~ 4, 
    ALCDAY5 == 105 ~ 5,
    ALCDAY5 == 106 ~ 6,
    ALCDAY5 == 107 ~ 7,
    ALCDAY4 == 101 ~ 1,
    ALCDAY4 == 102 ~ 2,
    ALCDAY4 == 103 ~ 3,
    ALCDAY4 == 104 ~ 4,
    ALCDAY4 == 105 ~ 5,
    ALCDAY4 == 106 ~ 6,
    ALCDAY4 == 107 ~ 7)) |>
  group_by(age, sex, perweek, race) |>
  summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE),
            Alcoholic = sum(Alcoholic, na.rm = TRUE),
            SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE),
            Incarcerated = sum(Incarcerated, na.rm = TRUE),
            SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE),
            DomesticViolence = sum(DomesticViolence, na.rm = TRUE),
            PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE),
            EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE),
            SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE),
            SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE),
            SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE),
            Neglect1 = sum(Neglect1, na.rm = TRUE),
            Neglect2 = sum(Neglect2, na.rm = TRUE)) |>
  pivot_longer(c(5:17), names_to = "Category", values_to = "n") |>
  mutate(race = case_when(
    race == 1 ~ "White",
    race == 2 ~ "Black",
    race == 3 ~ "Asian",
    race == 4 ~ "AI/AN",
    race == 5 ~ "Hispanic",
    race == 6 ~ "Other"
  )) |>
  mutate(age = case_when(
    age == 1 ~ "18 to 24",
    age == 2 ~ "25 to 34",
    age == 3 ~ "35 to 44",
    age == 4 ~ "45 to 54",
    age == 5 ~ "55 to 64",
    age == 6 ~ "65 or > 65")) 


everything |> select(MentalIllness, sex, age, race, ALCDAY4, ALCDAY5,) |>
  mutate(perweek = case_when(
    ALCDAY5 == 101 ~ 1,
    ALCDAY5 == 102 ~ 2, 
    ALCDAY5 == 103 ~ 3,
    ALCDAY5 == 104 ~ 4, 
    ALCDAY5 == 105 ~ 5,
    ALCDAY5 == 106 ~ 6,
    ALCDAY5 == 107 ~ 7,
    ALCDAY4 == 101 ~ 1,
    ALCDAY4 == 102 ~ 2,
    ALCDAY4 == 103 ~ 3,
    ALCDAY4 == 104 ~ 4,
    ALCDAY4 == 105 ~ 5,
    ALCDAY4 == 106 ~ 6,
    ALCDAY4 == 107 ~ 7)) |>
  # group_by(age, sex, perweek) |>
  # summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE),
  #           Alcoholic = sum(Alcoholic, na.rm = TRUE),
  #           SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE),
  #           Incarcerated = sum(Incarcerated, na.rm = TRUE),
  #           SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE),
  #           DomesticViolence = sum(DomesticViolence, na.rm = TRUE),
  #           PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE),
  #           EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE),
  #           SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE),
  #           SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE),
  #           SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE),
  #           Neglect1 = sum(Neglect1, na.rm = TRUE),
  #           Neglect2 = sum(Neglect2, na.rm = TRUE)) |>
  # pivot_longer(c(4:16), names_to = "Category", values_to = "n") |>
  mutate(age = case_when(
    age == 1 ~ "18 to 24",
    age == 2 ~ "25 to 34",
    age == 3 ~ "35 to 44",
    age == 4 ~ "45 to 54",
    age == 5 ~ "55 to 64",
    age == 6 ~ "65 or > 65")) |>
  mutate(race = case_when(
    race == 1 ~ "White",
    race == 2 ~ "Black",
    race == 3 ~ "Asian",
    race == 4 ~ "AI/AN",
    race == 5 ~ "Hispanic",
    race == 6 ~ "Other"
  )) |>
  filter(race == "White") |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  mutate(MentalIllness = if_else(MentalIllness == 1, "Yes", "No")) |>
  filter(!is.na(perweek)) |>
  filter(!is.na(MentalIllness)) |>
  group_by(perweek, MentalIllness, sex, age, race) |>
  summarise(n = n()) |>
  ggplot(aes(x = perweek, y = n, col = age, alpha = MentalIllness)) + 
  geom_line(linewidth = 1) +
  theme_minimal() +
  scale_color_viridis_d(option = "plasma", direction = 1, begin = 0.85, end = 0.35) +
  scale_alpha_manual(values = c(0.35, 1)) +
  facet_wrap(vars(race, sex)) + 
  labs(x = "Days Per Week (Alcohol Consumption)", y = "People") +
  theme(
    strip.text = element_text(color = "black", size = 16, family = "Avenir"),
    plot.title = element_text(color = "black", size = 18, family = "Avenir"),
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    axis.text = element_text(color = "black", size = 16, family = "Avenir"),
    axis.title = element_text(color = "black", size = 20, family = "Avenir")
  )



everything |> select(MentalIllness, sex, age, race, ALCDAY4, ALCDAY5,) |>
  mutate(perweek = case_when(
    ALCDAY5 == 101 ~ 1,
    ALCDAY5 == 102 ~ 2, 
    ALCDAY5 == 103 ~ 3,
    ALCDAY5 == 104 ~ 4, 
    ALCDAY5 == 105 ~ 5,
    ALCDAY5 == 106 ~ 6,
    ALCDAY5 == 107 ~ 7,
    ALCDAY4 == 101 ~ 1,
    ALCDAY4 == 102 ~ 2,
    ALCDAY4 == 103 ~ 3,
    ALCDAY4 == 104 ~ 4,
    ALCDAY4 == 105 ~ 5,
    ALCDAY4 == 106 ~ 6,
    ALCDAY4 == 107 ~ 7)) |>
  # group_by(age, sex, perweek) |>
  # summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE),
  #           Alcoholic = sum(Alcoholic, na.rm = TRUE),
  #           SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE),
  #           Incarcerated = sum(Incarcerated, na.rm = TRUE),
  #           SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE),
  #           DomesticViolence = sum(DomesticViolence, na.rm = TRUE),
  #           PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE),
  #           EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE),
  #           SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE),
  #           SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE),
  #           SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE),
  #           Neglect1 = sum(Neglect1, na.rm = TRUE),
  #           Neglect2 = sum(Neglect2, na.rm = TRUE)) |>
  # pivot_longer(c(4:16), names_to = "Category", values_to = "n") |>
  mutate(age = case_when(
    age == 1 ~ "18 to 24",
    age == 2 ~ "25 to 34",
    age == 3 ~ "35 to 44",
    age == 4 ~ "45 to 54",
    age == 5 ~ "55 to 64",
    age == 6 ~ "65 or > 65")) |>
  mutate(race = case_when(
    race == 1 ~ "White",
    race == 2 ~ "Black",
    race == 3 ~ "Asian",
    race == 4 ~ "AI/AN",
    race == 5 ~ "Hispanic",
    race == 6 ~ "Other"
  )) |>
  filter(race == "Black") |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  mutate(MentalIllness = if_else(MentalIllness == 1, "Yes", "No")) |>
  filter(!is.na(perweek)) |>
  filter(!is.na(MentalIllness)) |>
  group_by(perweek, MentalIllness, sex, age, race) |>
  summarise(n = n()) |>
  ggplot(aes(x = perweek, y = n, col = age, alpha = MentalIllness)) + 
  geom_line(linewidth = 1) +
  theme_minimal() +
  scale_color_viridis_d(option = "plasma", direction = 1, begin = 0.85, end = 0.35) +
  scale_alpha_manual(values = c(0.35, 1)) +
  facet_wrap(vars(race, sex)) + 
  labs(x = "Days Per Week (Alcohol Consumption)", y = "People") +
  theme(
    strip.text = element_text(color = "black", size = 16, family = "Avenir"),
    plot.title = element_text(color = "black", size = 18, family = "Avenir"),
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    axis.text = element_text(color = "black", size = 16, family = "Avenir"),
    axis.title = element_text(color = "black", size = 20, family = "Avenir")
  )

everything |> select(MentalIllness, sex, age, race, ALCDAY4, ALCDAY5,) |>
  mutate(perweek = case_when(
    ALCDAY5 == 101 ~ 1,
    ALCDAY5 == 102 ~ 2, 
    ALCDAY5 == 103 ~ 3,
    ALCDAY5 == 104 ~ 4, 
    ALCDAY5 == 105 ~ 5,
    ALCDAY5 == 106 ~ 6,
    ALCDAY5 == 107 ~ 7,
    ALCDAY4 == 101 ~ 1,
    ALCDAY4 == 102 ~ 2,
    ALCDAY4 == 103 ~ 3,
    ALCDAY4 == 104 ~ 4,
    ALCDAY4 == 105 ~ 5,
    ALCDAY4 == 106 ~ 6,
    ALCDAY4 == 107 ~ 7)) |>
  # group_by(age, sex, perweek) |>
  # summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE),
  #           Alcoholic = sum(Alcoholic, na.rm = TRUE),
  #           SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE),
  #           Incarcerated = sum(Incarcerated, na.rm = TRUE),
  #           SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE),
  #           DomesticViolence = sum(DomesticViolence, na.rm = TRUE),
  #           PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE),
  #           EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE),
  #           SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE),
  #           SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE),
  #           SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE),
  #           Neglect1 = sum(Neglect1, na.rm = TRUE),
  #           Neglect2 = sum(Neglect2, na.rm = TRUE)) |>
  # pivot_longer(c(4:16), names_to = "Category", values_to = "n") |>
  mutate(age = case_when(
    age == 1 ~ "18 to 24",
    age == 2 ~ "25 to 34",
    age == 3 ~ "35 to 44",
    age == 4 ~ "45 to 54",
    age == 5 ~ "55 to 64",
    age == 6 ~ "65 or > 65")) |>
  mutate(race = case_when(
    race == 1 ~ "White",
    race == 2 ~ "Black",
    race == 3 ~ "Asian",
    race == 4 ~ "AI/AN",
    race == 5 ~ "Hispanic",
    race == 6 ~ "Other"
  )) |>
  filter(race == "Asian") |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  mutate(MentalIllness = if_else(MentalIllness == 1, "Yes", "No")) |>
  filter(!is.na(perweek)) |>
  filter(!is.na(MentalIllness)) |>
  group_by(perweek, MentalIllness, sex, age, race) |>
  summarise(n = n()) |>
  ggplot(aes(x = perweek, y = n, col = age, alpha = MentalIllness)) + 
  geom_line(linewidth = 1) +
  theme_minimal() +
  scale_color_viridis_d(option = "plasma", direction = 1, begin = 0.85, end = 0.35) +
  scale_alpha_manual(values = c(0.35, 1)) +
  facet_wrap(vars(race, sex)) + 
  labs(x = "Days Per Week (Alcohol Consumption)", y = "People") +
  theme(
    strip.text = element_text(color = "black", size = 16, family = "Avenir"),
    plot.title = element_text(color = "black", size = 18, family = "Avenir"),
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    axis.text = element_text(color = "black", size = 16, family = "Avenir"),
    axis.title = element_text(color = "black", size = 20, family = "Avenir")
  )

everything |> select(MentalIllness, sex, age, race, ALCDAY4, ALCDAY5,) |>
  mutate(perweek = case_when(
    ALCDAY5 == 101 ~ 1,
    ALCDAY5 == 102 ~ 2, 
    ALCDAY5 == 103 ~ 3,
    ALCDAY5 == 104 ~ 4, 
    ALCDAY5 == 105 ~ 5,
    ALCDAY5 == 106 ~ 6,
    ALCDAY5 == 107 ~ 7,
    ALCDAY4 == 101 ~ 1,
    ALCDAY4 == 102 ~ 2,
    ALCDAY4 == 103 ~ 3,
    ALCDAY4 == 104 ~ 4,
    ALCDAY4 == 105 ~ 5,
    ALCDAY4 == 106 ~ 6,
    ALCDAY4 == 107 ~ 7)) |>
  # group_by(age, sex, perweek) |>
  # summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE),
  #           Alcoholic = sum(Alcoholic, na.rm = TRUE),
  #           SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE),
  #           Incarcerated = sum(Incarcerated, na.rm = TRUE),
  #           SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE),
  #           DomesticViolence = sum(DomesticViolence, na.rm = TRUE),
  #           PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE),
  #           EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE),
  #           SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE),
  #           SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE),
  #           SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE),
  #           Neglect1 = sum(Neglect1, na.rm = TRUE),
  #           Neglect2 = sum(Neglect2, na.rm = TRUE)) |>
  # pivot_longer(c(4:16), names_to = "Category", values_to = "n") |>
  mutate(age = case_when(
    age == 1 ~ "18 to 24",
    age == 2 ~ "25 to 34",
    age == 3 ~ "35 to 44",
    age == 4 ~ "45 to 54",
    age == 5 ~ "55 to 64",
    age == 6 ~ "65 or > 65")) |>
  mutate(race = case_when(
    race == 1 ~ "White",
    race == 2 ~ "Black",
    race == 3 ~ "Asian",
    race == 4 ~ "AI/AN",
    race == 5 ~ "Hispanic",
    race == 6 ~ "Other"
  )) |>
  filter(race == "AI/AN") |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  mutate(MentalIllness = if_else(MentalIllness == 1, "Yes", "No")) |>
  filter(!is.na(perweek)) |>
  filter(!is.na(MentalIllness)) |>
  group_by(perweek, MentalIllness, sex, age, race) |>
  summarise(n = n()) |>
  ggplot(aes(x = perweek, y = n, col = age, alpha = MentalIllness)) + 
  geom_line(linewidth = 1) +
  theme_minimal() +
  scale_color_viridis_d(option = "plasma", direction = 1, begin = 0.85, end = 0.35) +
  scale_alpha_manual(values = c(0.35, 1)) +
  facet_wrap(vars(race, sex)) + 
  labs(x = "Days Per Week (Alcohol Consumption)", y = "People") +
  theme(
    strip.text = element_text(color = "black", size = 16, family = "Avenir"),
    plot.title = element_text(color = "black", size = 18, family = "Avenir"),
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    axis.text = element_text(color = "black", size = 16, family = "Avenir"),
    axis.title = element_text(color = "black", size = 20, family = "Avenir")
  )


everything |> select(MentalIllness, sex, age, race, ALCDAY4, ALCDAY5,) |>
  mutate(perweek = case_when(
    ALCDAY5 == 101 ~ 1,
    ALCDAY5 == 102 ~ 2, 
    ALCDAY5 == 103 ~ 3,
    ALCDAY5 == 104 ~ 4, 
    ALCDAY5 == 105 ~ 5,
    ALCDAY5 == 106 ~ 6,
    ALCDAY5 == 107 ~ 7,
    ALCDAY4 == 101 ~ 1,
    ALCDAY4 == 102 ~ 2,
    ALCDAY4 == 103 ~ 3,
    ALCDAY4 == 104 ~ 4,
    ALCDAY4 == 105 ~ 5,
    ALCDAY4 == 106 ~ 6,
    ALCDAY4 == 107 ~ 7)) |>
  # group_by(age, sex, perweek) |>
  # summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE),
  #           Alcoholic = sum(Alcoholic, na.rm = TRUE),
  #           SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE),
  #           Incarcerated = sum(Incarcerated, na.rm = TRUE),
  #           SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE),
  #           DomesticViolence = sum(DomesticViolence, na.rm = TRUE),
  #           PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE),
  #           EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE),
  #           SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE),
  #           SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE),
  #           SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE),
  #           Neglect1 = sum(Neglect1, na.rm = TRUE),
  #           Neglect2 = sum(Neglect2, na.rm = TRUE)) |>
  # pivot_longer(c(4:16), names_to = "Category", values_to = "n") |>
  mutate(age = case_when(
    age == 1 ~ "18 to 24",
    age == 2 ~ "25 to 34",
    age == 3 ~ "35 to 44",
    age == 4 ~ "45 to 54",
    age == 5 ~ "55 to 64",
    age == 6 ~ "65 or > 65")) |>
  mutate(race = case_when(
    race == 1 ~ "White",
    race == 2 ~ "Black",
    race == 3 ~ "Asian",
    race == 4 ~ "AI/AN",
    race == 5 ~ "Hispanic",
    race == 6 ~ "Other"
  )) |>
  filter(race == "Hispanic") |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  mutate(MentalIllness = if_else(MentalIllness == 1, "Yes", "No")) |>
  filter(!is.na(perweek)) |>
  filter(!is.na(MentalIllness)) |>
  group_by(perweek, MentalIllness, sex, age, race) |>
  summarise(n = n()) |>
  ggplot(aes(x = perweek, y = n, col = age, alpha = MentalIllness)) + 
  geom_line(linewidth = 1) +
  theme_minimal() +
  scale_color_viridis_d(option = "plasma", direction = 1, begin = 0.85, end = 0.35) +
  scale_alpha_manual(values = c(0.35, 1)) +
  facet_wrap(vars(race, sex)) + 
  labs(x = "Days Per Week (Alcohol Consumption)", y = "People") +
  theme(
    strip.text = element_text(color = "black", size = 16, family = "Avenir"),
    plot.title = element_text(color = "black", size = 18, family = "Avenir"),
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    axis.text = element_text(color = "black", size = 16, family = "Avenir"),
    axis.title = element_text(color = "black", size = 20, family = "Avenir")
  )


everything |> select(MentalIllness, sex, age, race, ALCDAY4, ALCDAY5,) |>
  mutate(perweek = case_when(
    ALCDAY5 == 101 ~ 1,
    ALCDAY5 == 102 ~ 2, 
    ALCDAY5 == 103 ~ 3,
    ALCDAY5 == 104 ~ 4, 
    ALCDAY5 == 105 ~ 5,
    ALCDAY5 == 106 ~ 6,
    ALCDAY5 == 107 ~ 7,
    ALCDAY4 == 101 ~ 1,
    ALCDAY4 == 102 ~ 2,
    ALCDAY4 == 103 ~ 3,
    ALCDAY4 == 104 ~ 4,
    ALCDAY4 == 105 ~ 5,
    ALCDAY4 == 106 ~ 6,
    ALCDAY4 == 107 ~ 7)) |>
  # group_by(age, sex, perweek) |>
  # summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE),
  #           Alcoholic = sum(Alcoholic, na.rm = TRUE),
  #           SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE),
  #           Incarcerated = sum(Incarcerated, na.rm = TRUE),
  #           SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE),
  #           DomesticViolence = sum(DomesticViolence, na.rm = TRUE),
  #           PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE),
  #           EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE),
  #           SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE),
  #           SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE),
  #           SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE),
  #           Neglect1 = sum(Neglect1, na.rm = TRUE),
  #           Neglect2 = sum(Neglect2, na.rm = TRUE)) |>
  # pivot_longer(c(4:16), names_to = "Category", values_to = "n") |>
  mutate(age = case_when(
    age == 1 ~ "18 to 24",
    age == 2 ~ "25 to 34",
    age == 3 ~ "35 to 44",
    age == 4 ~ "45 to 54",
    age == 5 ~ "55 to 64",
    age == 6 ~ "65 or > 65")) |>
  mutate(race = case_when(
    race == 1 ~ "White",
    race == 2 ~ "Black",
    race == 3 ~ "Asian",
    race == 4 ~ "AI/AN",
    race == 5 ~ "Hispanic",
    race == 6 ~ "Other"
  )) |>
  filter(race == "Other") |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  mutate(MentalIllness = if_else(MentalIllness == 1, "Yes", "No")) |>
  filter(!is.na(perweek)) |>
  filter(!is.na(MentalIllness)) |>
  group_by(perweek, MentalIllness, sex, age, race) |>
  summarise(n = n()) |>
  ggplot(aes(x = perweek, y = n, col = age, alpha = MentalIllness)) + 
  geom_line(linewidth = 1) +
  theme_minimal() +
  scale_color_viridis_d(option = "plasma", direction = 1, begin = 0.85, end = 0.35) +
  scale_alpha_manual(values = c(0.35, 1)) +
  facet_wrap(vars(race, sex)) + 
  labs(x = "Days Per Week (Alcohol Consumption)", y = "People") +
  theme(
    strip.text = element_text(color = "black", size = 16, family = "Avenir"),
    plot.title = element_text(color = "black", size = 18, family = "Avenir"),
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    axis.text = element_text(color = "black", size = 16, family = "Avenir"),
    axis.title = element_text(color = "black", size = 20, family = "Avenir")
  )
```


```{r}
ggplot(aes(x = perweek, col = age, group = age, fill = age)) + 
  geom_histogram(aes(x = perweek), bins = 7) +
  scale_color_viridis_d(option = "plasma", direction = 1, begin = 0.85, end = 0) +
  scale_fill_viridis_d(option = "plasma", direction = 1, begin = 0.85, end = 0) +
  facet_wrap(~sex)



  alcperweek |> select(age, sex, perweek) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  ggplot(aes(x = perweek, col = age, group = age)) +
  geom_density(alpha = 0.4, n = 7, aes(col = age, group = age), linewidth = 1) +
  scale_color_viridis_d(option = "plasma", direction = 1, begin = 0.85, end = 0) +
  theme_minimal() +
  facet_wrap(~sex) + 
  labs(x = "Days Per Week (Alcohol Consumption)", y = "PDF", title = "Mental Illness in House Hold") +
  theme(
    strip.text = element_text(color = "black", size = 16, family = "Avenir"),
    plot.title = element_text(color = "black", size = 18, family = "Avenir"),
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    axis.text = element_text(color = "black", size = 16, family = "Avenir"),
    axis.title = element_text(color = "black", size = 20, family = "Avenir")
  )

  
  
  two = alcperweek |> select(age, sex, perweek, Alcoholic) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  ggplot(aes(x = perweek, col = age, group = age)) +
  geom_density(alpha = 0.4, n = 7, aes(col = age, group = age), linewidth = 1) +
  scale_color_viridis_d(option = "plasma", direction = 1, begin = 0.85, end = 0) +
  theme_minimal() +
  facet_wrap(~sex) + 
  labs(x = "Days Per Week (Alcohol Consumption)", y = "PDF", title = "Alcohol Abuse in House Hold") +
  theme(
    strip.text = element_text(color = "black", size = 16, family = "Avenir"),
    plot.title = element_text(color = "black", size = 18, family = "Avenir"),
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    axis.text = element_text(color = "black", size = 16, family = "Avenir"),
    axis.title = element_text(color = "black", size = 20, family = "Avenir")
  )
  
  alcperweek |> select(age, sex, perweek, SexualAbuse1) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  ggplot(aes(x = perweek, col = age, group = age)) +
  geom_density(alpha = 0.4, n = 7, aes(col = age, group = age), linewidth = 1) +
  scale_color_viridis_d(option = "plasma", direction = 1, begin = 0.85, end = 0) +
  theme_minimal() +
  facet_wrap(~sex) + 
  labs(x = "Days Per Week (Alcohol Consumption)", y = "PDF", title = "Incarcerated House Hold Member") +
  theme(
    strip.text = element_text(color = "black", size = 16, family = "Avenir"),
    plot.title = element_text(color = "black", size = 18, family = "Avenir"),
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    axis.text = element_text(color = "black", size = 16, family = "Avenir"),
    axis.title = element_text(color = "black", size = 20, family = "Avenir")
  )
  
  
  alcperweek |> select(age, sex, perweek, SeparationDivorce) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  ggplot(aes(x = perweek, col = age, group = age)) +
  geom_density(alpha = 0.4, n = 7, aes(col = age, group = age), linewidth = 1) +
  scale_color_viridis_d(option = "plasma", direction = 1, begin = 0.85, end = 0) +
  theme_minimal() +
  facet_wrap(~sex) + 
  labs(x = "Days Per Week (Alcohol Consumption)", y = "PDF", title = "Parental Separation/Divorce") +
  theme(
    strip.text = element_text(color = "black", size = 16, family = "Avenir"),
    plot.title = element_text(color = "black", size = 18, family = "Avenir"),
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    axis.text = element_text(color = "black", size = 16, family = "Avenir"),
    axis.title = element_text(color = "black", size = 20, family = "Avenir")
  )
  
  





geom_col() + 
  facet_wrap(~Category)

  geom_density()geom_point() +
  scale_fill_viridis_d(option = "plasma") +
  facet_wrap(~Category)
  
  
  geom_col(aes(fill = age, col = sex)) +
  theme_minimal() +
  scale_color_brewer(palette = "Pastel1", direction = -1) +
  scale_fill_viridis_d(option = "plasma") +
  facet_wrap(~Category)


  facet_wrap(vars(race, sex))
  
```















```{r}

## Question: Considering all types of alcoholic beverages, how many times during the past 30 days did you have 5 or more drinks for men or 4 or more drinks for women on an occasion?

DRNK3GE5 = everything |> select(MentalIllness, Alcoholic, Incarcerated, SeparationDivorce, DomesticViolence, PhysicalAbuse, EmotionalAbuse, SexualAbuse1, SexualAbuse2, SexualAbuse3, Neglect1, Neglect2, SubstanceAddiction, DRNK3GE5, sex, age, race, number) |>
  filter(DRNK3GE5 != 88) |>
  filter(DRNK3GE5 != 77) |>
  filter(DRNK3GE5 != 99) |>
  filter(!is.na(DRNK3GE5))



DRNK3GE5all1 = glm(DRNK3GE5 ~ age + sex + race +
                    MentalIllness + 
                    Alcoholic + 
                    SubstanceAddiction + 
                    Incarcerated + 
                    SeparationDivorce + 
                    DomesticViolence +
                    PhysicalAbuse + 
                    EmotionalAbuse + 
                    SexualAbuse1 + 
                    SexualAbuse2 + 
                    SexualAbuse3 + 
                    Neglect1 + 
                    Neglect2, 
                  family = "quasipoisson", data = DRNK3GE5)
summary(DRNK3GE5all1)


everything |> select(MentalIllness, Alcoholic, Incarcerated, SeparationDivorce, DomesticViolence, PhysicalAbuse, EmotionalAbuse, SexualAbuse1, SexualAbuse2, SexualAbuse3, Neglect1, Neglect2, SubstanceAddiction, DRNK3GE5, sex, age, race, number) |>
  filter(DRNK3GE5 != 88) |>
  filter(DRNK3GE5 != 77) |>
  filter(DRNK3GE5 != 99) |>
  filter(!is.na(DRNK3GE5)) |>
  group_by(age, sex, perweek) |>
summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE),
            Alcoholic = sum(Alcoholic, na.rm = TRUE),
            SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE),
            Incarcerated = sum(Incarcerated, na.rm = TRUE),
            SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE),
            DomesticViolence = sum(DomesticViolence, na.rm = TRUE),
            PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE),
            EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE),
            SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE),
            SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE),
            SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE),
            Neglect1 = sum(Neglect1, na.rm = TRUE),
            Neglect2 = sum(Neglect2, na.rm = TRUE)) |>
  pivot_longer(c(5:17), names_to = "Category", values_to = "n")



```















































state_df = data.frame(state.center, state=state.name)

left_join(state_df, ace_state) |> ggplot(aes(x = x, y = y)) +
  geom_polygon()



ggplot2::map_data("usa")

state_df |> distinct(region)



```{r}
library(rnaturalearth)
library(rnaturalearthdata)
library(sf)

state_df <- ggplot2::map_data("state")

states = tibble(state.name = state.name) |> mutate(number = c(1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49, 50, 51, 53, 54, 55, 56))
otherstates = tibble(state.name = c("District of Columbia", "Guam", "Puerto Rico", "Virgin Islands"),
       number = c(11, 66, 72, 78))
states = full_join(states, otherstates)

ace_state = left_join(everything, states, by = c("state" = "number")) 
ace_state = ace_state |> group_by(state.name) |> 
  summarise(n = n()) |>
  mutate(state.name = str_to_lower(state.name)) |>
  rename("state" = "state.name", 
         "values" = n) |>
  mutate(state = str_to_title(state))



data = rnaturalearthdata::states50
class(data)

data = data |> filter(admin == "United States of America") 

data = left_join(data, ace_state, by = c("name" = "state"))

data |> 
  ggplot() +
  geom_polygon(aes(x = geometry))

(mainland = data |> 
  ggplot(fill = values, col = values) +
  theme_void() +
  scale_fill_distiller(palette = "PuRd", direction = 1, na.value = "black") +
  geom_sf() +
     coord_sf(crs = st_crs(2163), xlim = c(-2500000, 2500000), ylim = c(-2300000, 
         730000)))

(alaska <- ggplot(data = data) +
     geom_sf() +
     coord_sf(crs = st_crs(3467), xlim = c(-2400000, 1600000), ylim = c(200000, 
         2500000), expand = FALSE, datum = NA))


(hawaii  <- ggplot(data = data) +
     geom_sf() +
     coord_sf(crs = st_crs(4135), xlim = c(-161, -154), ylim = c(18, 
         23), expand = FALSE, datum = NA))


mainland +
 annotation_custom(
      grob = ggplotGrob(alaska),
      xmin = -2750000,
      xmax = -2750000 + (1600000 - (-2400000))/2.5,
      ymin = -2450000,
      ymax = -2450000 + (2500000 - 200000)/2.5
  ) +
  annotation_custom(
      grob = ggplotGrob(hawaii),
      xmin = -1250000,
      xmax = -1250000 + (-154 - (-161))*120000,
      ymin = -2450000,
      ymax = -2450000 + (23 - 18)*120000
  ) 



  



  
```
























