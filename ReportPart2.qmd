---
title: "Report Part 2"
format:
  html:
    embed-resources: true
    warning: false
    message: false
documentclass: article
author: "Bryana A. S. Thieret"
mainfont: "Cambria"
monofont: "Cambria"
---

## Introduction  


### Data 


### Definitions  







```{r ALL PACKAGES AND DATA}
library(tidyverse)
library(readr)
library(here)
library(haven)
library(emmeans)
library(lmerTest)
library(lme4)
library(plotly)
library(maps)
library(mapproj)
library(usmap)
library(knitr)

twenty022 <- read_xpt(here::here("LLCP2022.XPT ")) ## space after T 
twenty021 <- read_xpt(here::here("LLCP2021.XPT"))
twenty020 <- read_xpt(here::here("LLCP2020.XPT"))
twenty019 <- read_xpt(here::here("LLCP2019.XPT"))

## 2022: 
twenty022 = twenty022 |> select(
                    IYEAR, '_STATE', SEXVAR, MARITAL, VETERAN3, INCOME3, "_BMI5", 
                    EDUCA, RENTHOM1, EMPLOY1, CHILDREN, CAREGIV1, CRGVREL4, CRGVLNG1, CRGVPRB3, SDHEMPLY, FOODSTMP, SDHFOOD1, SDHBILLS, SDHUTILS, SOMALE, TRNSGNDR, RRCLASS3, "_METSTAT", "_URBSTAT", "_IMPRACE", "_AGE_G",
                    GENHLTH, PHYSHLTH, MENTHLTH, POORHLTH, EXERANY2, SLEPTIM1, LASTDEN4, CVDINFR4, CVDCRHD4, CVDSTRK3, ASTHMA3, CHCSCNC1, CHCOCNC1, CHCCOPD3, ADDEPEV3, CHCKDNY2, HAVARTH4, DIABETE4, DEAF, BLIND, DIFFWALK, DIFFDRES, DIFFALON, PREDIAB2,
                      DIABTYPE, CNCRTYP2,  LSATISFY, EMTSUPRT, SDHISOLT, SDHSTRE1, 
                    SMOKE100, SMOKDAY2, USENOW3, ECIGNOW2, LCSFIRST, LCSLAST, LCSNUMCG, LCSSCNCR, ALCDAY4, AVEDRNK3, DRNK3GE5, MAXDRNKS, COPDSMOK, MARIJAN1, MARJSMOK, LASTSMK2, 
                    PRIMINSR, MEDCOST1, 
                    ACEDEPRS, ACEDRINK, ACEDRUGS, ACEPRISN, 
                    ACEDIVRC, ACEPUNCH, ACEHURT1, ACESWEAR,
                    ACETOUCH, ACETTHEM, ACEHVSEX, ACEADSAF, 
                    ACEADNED) |> 
  filter(!is.na(ACEDEPRS) | !is.na(ACEDRINK) | !is.na(ACEDRUGS) | !is.na(ACEPRISN) | 
           !is.na(ACEDIVRC) | !is.na(ACEPUNCH) | !is.na(ACEHURT1) | !is.na(ACESWEAR) | 
           !is.na(ACETOUCH) | !is.na(ACETTHEM) | !is.na(ACEHVSEX) | !is.na(ACEADSAF) |
           !is.na(ACEADNED)) |>
  rename("state" = "_STATE",
         "age" = "_AGE_G",
         "race" = "_IMPRACE",
         "sex" = SEXVAR,
        "MentalIllness" = ACEDEPRS,
         "Alcoholic" = ACEDRINK,
         "SubstanceAddiction" = ACEDRUGS,
         "Incarcerated" = ACEPRISN,
         "SeparationDivorce" = ACEDIVRC,
         "DomesticViolence" = ACEPUNCH,
         "PhysicalAbuse" = ACEHURT1,
         "EmotionalAbuse" = ACESWEAR,
         "SexualAbuse1" = ACETOUCH,
         "SexualAbuse2" = ACETTHEM,
         "SexualAbuse3" = ACEHVSEX,
         "Neglect1" = ACEADSAF,
         "Neglect2" = ACEADNED) |>
mutate(MentalIllness = case_when(
  MentalIllness == 1 ~ 1,
  MentalIllness == 2 ~ 0,
  MentalIllness == 7 ~ NA,
  MentalIllness == 9 ~ NA)) |>
  mutate(Alcoholic = case_when(
    Alcoholic == 1 ~ 1,
    Alcoholic == 2 ~ 0,
    Alcoholic == 7 ~ NA,
    Alcoholic == 9 ~ NA)) |> 
  mutate(SubstanceAddiction = case_when(
    SubstanceAddiction == 1 ~ 1,
    SubstanceAddiction == 2 ~ 0,
    SubstanceAddiction == 7 ~ NA,
    SubstanceAddiction == 9 ~ NA)) |>
  mutate(Incarcerated = case_when(
    Incarcerated == 1 ~ 1,
    Incarcerated == 2 ~ 0,
    Incarcerated == 7 ~ NA,
    Incarcerated == 9 ~ NA)) |> 
  mutate(SeparationDivorce = case_when(
    SeparationDivorce == 1 ~ 1,
    SeparationDivorce == 2 ~ 0,
    SeparationDivorce == 7 ~ NA,
    SeparationDivorce == 8 ~ NA,
    SeparationDivorce == 9 ~ NA)) |>
  mutate(DomesticViolence = case_when(
    DomesticViolence == 1 ~ 0,
    DomesticViolence == 2 ~ 1, 
    DomesticViolence == 3 ~ 1,
    DomesticViolence == 7 ~ NA,
    DomesticViolence == 9 ~ NA)) |>
  mutate(PhysicalAbuse = case_when(
    PhysicalAbuse == 1 ~ 0,
    PhysicalAbuse == 2 ~ 1,
    PhysicalAbuse == 3 ~ 1,
    PhysicalAbuse == 7 ~ NA,
    PhysicalAbuse == 9 ~ NA)) |>
  mutate(EmotionalAbuse = case_when(
    EmotionalAbuse == 1 ~ 0,
    EmotionalAbuse == 2 ~ 1, 
    EmotionalAbuse == 3 ~ 1,
    EmotionalAbuse == 7 ~ NA,
    EmotionalAbuse == 9 ~ NA)) |>
  mutate(SexualAbuse1 = case_when(
    SexualAbuse1 == 1 ~ 0,
    SexualAbuse1 == 2 ~ 1,
    SexualAbuse1 == 3 ~ 1,
    SexualAbuse1 == 7 ~ NA,
    SexualAbuse1 == 9 ~ NA)) |>
  mutate(SexualAbuse2 = case_when(
    SexualAbuse2 == 1 ~ 0,
    SexualAbuse2 == 2 ~ 1,
    SexualAbuse2 == 3 ~ 1,
    SexualAbuse2 == 7 ~ NA,
    SexualAbuse2 == 9 ~ NA)) |> 
  mutate(SexualAbuse3 = case_when(
    SexualAbuse3 == 1 ~ 0,
    SexualAbuse3 == 2 ~ 1,
    SexualAbuse3 == 3 ~ 1,
    SexualAbuse3 == 7 ~ NA,
    SexualAbuse3 == 9 ~ NA)) |>
  mutate(Neglect1 = case_when(
    Neglect1 == NA ~ NA,
    Neglect1 == 1 ~ 0,
    Neglect1 == 2 ~ 1,
    Neglect1 == 3 ~ 1,
    Neglect1 == 4 ~ 1,
    Neglect1 == 5 ~ 1,
    Neglect1 == 7 ~ NA,
    Neglect1 == 9 ~ NA)) |>
  mutate(Neglect2 = case_when(
    Neglect2 == 1 ~ 0,
    Neglect2 == 2 ~ 1,
    Neglect2 == 3 ~ 1,
    Neglect2 == 4 ~ 1,
    Neglect2 == 5 ~ 1,
    Neglect2 == NA ~ NA,
    Neglect2 == 7 ~ NA,
    Neglect2 == 9 ~ NA)) |>
  mutate(number = 1)

## 2021: 
twenty021 = twenty021 |> select(
                    IYEAR, '_STATE', SEXVAR, MARITAL, VETERAN3, INCOME3, "_BMI5",
                    EDUCA, RENTHOM1, EMPLOY1, CHILDREN, CAREGIV1, CRGVREL4, CRGVLNG1, CRGVPRB3, SOMALE, TRNSGNDR, "_METSTAT", "_URBSTAT", "_IMPRACE", "_AGE_G",
                    GENHLTH, PHYSHLTH, MENTHLTH, POORHLTH, EXERANY2, CVDINFR4, CVDCRHD4, CVDSTRK3, ASTHMA3, ADDEPEV3, CHCKDNY2, DIABETE4, DEAF, BLIND, DIFFWALK, DIFFDRES, DIFFALON,
                    SMOKE100, SMOKDAY2, USENOW3, LCSFIRST, LCSLAST, LCSNUMCG, ECIGNOW1, AVEDRNK3, ALCDAY5, DRNK3GE5, MAXDRNKS, MARIJAN1, LASTSMK2, 
                    PRIMINSR, MEDCOST1, 
                    ACEDEPRS, ACEDRINK, ACEDRUGS, ACEPRISN, 
                    ACEDIVRC, ACEPUNCH, ACEHURT1, ACESWEAR,
                    ACETOUCH, ACETTHEM, ACEHVSEX, ACEADSAF, 
                    ACEADNED) |> 
  filter(!is.na(ACEDEPRS) | !is.na(ACEDRINK) | !is.na(ACEDRUGS) | !is.na(ACEPRISN) | 
           !is.na(ACEDIVRC) | !is.na(ACEPUNCH) | !is.na(ACEHURT1) | !is.na(ACESWEAR) | 
           !is.na(ACETOUCH) | !is.na(ACETTHEM) | !is.na(ACEHVSEX) | !is.na(ACEADSAF) |
           !is.na(ACEADNED)) |>
  rename("state" = "_STATE",
         "age" = "_AGE_G",
         "race" = "_IMPRACE",
         "sex" = SEXVAR,
        "MentalIllness" = ACEDEPRS,
         "Alcoholic" = ACEDRINK,
         "SubstanceAddiction" = ACEDRUGS,
         "Incarcerated" = ACEPRISN,
         "SeparationDivorce" = ACEDIVRC,
         "DomesticViolence" = ACEPUNCH,
         "PhysicalAbuse" = ACEHURT1,
         "EmotionalAbuse" = ACESWEAR,
         "SexualAbuse1" = ACETOUCH,
         "SexualAbuse2" = ACETTHEM,
         "SexualAbuse3" = ACEHVSEX,
         "Neglect1" = ACEADSAF,
         "Neglect2" = ACEADNED) |> 
  mutate(MentalIllness = case_when(
  MentalIllness == 1 ~ 1,
  MentalIllness == 2 ~ 0,
  MentalIllness == 7 ~ NA,
  MentalIllness == 9 ~ NA)) |>
  mutate(Alcoholic = case_when(
    Alcoholic == 1 ~ 1,
    Alcoholic == 2 ~ 0,
    Alcoholic == 7 ~ NA,
    Alcoholic == 9 ~ NA)) |> 
  mutate(SubstanceAddiction = case_when(
    SubstanceAddiction == 1 ~ 1,
    SubstanceAddiction == 2 ~ 0,
    SubstanceAddiction == 7 ~ NA,
    SubstanceAddiction == 9 ~ NA)) |>
  mutate(Incarcerated = case_when(
    Incarcerated == 1 ~ 1,
    Incarcerated == 2 ~ 0,
    Incarcerated == 7 ~ NA,
    Incarcerated == 9 ~ NA)) |> 
  mutate(SeparationDivorce = case_when(
    SeparationDivorce == 1 ~ 1,
    SeparationDivorce == 2 ~ 0,
    SeparationDivorce == 7 ~ NA,
    SeparationDivorce == 8 ~ NA,
    SeparationDivorce == 9 ~ NA)) |>
  mutate(DomesticViolence = case_when(
    DomesticViolence == 1 ~ 0,
    DomesticViolence == 2 ~ 1, 
    DomesticViolence == 3 ~ 1,
    DomesticViolence == 7 ~ NA,
    DomesticViolence == 9 ~ NA)) |>
  mutate(PhysicalAbuse = case_when(
    PhysicalAbuse == 1 ~ 0,
    PhysicalAbuse == 2 ~ 1,
    PhysicalAbuse == 3 ~ 1,
    PhysicalAbuse == 7 ~ NA,
    PhysicalAbuse == 9 ~ NA)) |>
  mutate(EmotionalAbuse = case_when(
    EmotionalAbuse == 1 ~ 0,
    EmotionalAbuse == 2 ~ 1, 
    EmotionalAbuse == 3 ~ 1,
    EmotionalAbuse == 7 ~ NA,
    EmotionalAbuse == 9 ~ NA)) |>
  mutate(SexualAbuse1 = case_when(
    SexualAbuse1 == 1 ~ 0,
    SexualAbuse1 == 2 ~ 1,
    SexualAbuse1 == 3 ~ 1,
    SexualAbuse1 == 7 ~ NA,
    SexualAbuse1 == 9 ~ NA)) |>
  mutate(SexualAbuse2 = case_when(
    SexualAbuse2 == 1 ~ 0,
    SexualAbuse2 == 2 ~ 1,
    SexualAbuse2 == 3 ~ 1,
    SexualAbuse2 == 7 ~ NA,
    SexualAbuse2 == 9 ~ NA)) |> 
  mutate(SexualAbuse3 = case_when(
    SexualAbuse3 == 1 ~ 0,
    SexualAbuse3 == 2 ~ 1,
    SexualAbuse3 == 3 ~ 1,
    SexualAbuse3 == 7 ~ NA,
    SexualAbuse3 == 9 ~ NA)) |>
  mutate(Neglect1 = case_when(
    Neglect1 == NA ~ NA,
    Neglect1 == 1 ~ 0,
    Neglect1 == 2 ~ 1,
    Neglect1 == 3 ~ 1,
    Neglect1 == 4 ~ 1,
    Neglect1 == 5 ~ 1,
    Neglect1 == 7 ~ NA,
    Neglect1 == 9 ~ NA)) |>
  mutate(Neglect2 = case_when(
    Neglect2 == 1 ~ 0,
    Neglect2 == 2 ~ 1,
    Neglect2 == 3 ~ 1,
    Neglect2 == 4 ~ 1,
    Neglect2 == 5 ~ 1,
    Neglect2 == NA ~ NA,
    Neglect2 == 7 ~ NA,
    Neglect2 == 9 ~ NA)) |>
  mutate(number = 2)

## 2020: 

twenty020 = twenty020 |> select(
                    IYEAR, '_STATE', SEXVAR, MARITAL, VETERAN3, INCOME2, WEIGHT2, HEIGHT3, 
                    EDUCA, RENTHOM1, EMPLOY1, CHILDREN, CAREGIV1, CRGVREL4, CRGVLNG1, CRGVPRB3, SOMALE, TRNSGNDR, "_METSTAT", "_URBSTAT", "_IMPRACE", "_AGE_G",
                    GENHLTH, PHYSHLTH, MENTHLTH, POORHLTH, EXERANY2, CVDINFR4, CVDCRHD4, CVDSTRK3, ASTHMA3, ADDEPEV3, CHCKDNY2, DIABETE4, DEAF, BLIND, DIFFWALK, DIFFDRES, DIFFALON,
                    SMOKE100, SMOKDAY2, USENOW3, LCSFIRST, LCSLAST, LCSNUMCG, ECIGNOW, AVEDRNK3, ALCDAY5, DRNK3GE5, MAXDRNKS, MARIJAN1, LASTSMK2, 
                    HLTHCVR1,
                    ACEDEPRS, ACEDRINK, ACEDRUGS, ACEPRISN, 
                    ACEDIVRC, ACEPUNCH, ACEHURT1, ACESWEAR,
                    ACETOUCH, ACETTHEM, ACEHVSEX) |> 
  filter(!is.na(ACEDEPRS) | !is.na(ACEDRINK) | !is.na(ACEDRUGS) | !is.na(ACEPRISN) | 
           !is.na(ACEDIVRC) | !is.na(ACEPUNCH) | !is.na(ACEHURT1) | !is.na(ACESWEAR) | 
           !is.na(ACETOUCH) | !is.na(ACETTHEM) | !is.na(ACEHVSEX)) |>
  rename("state" = "_STATE",
         "age" = "_AGE_G",
         "race" = "_IMPRACE",
         "sex" = SEXVAR,
        "MentalIllness" = ACEDEPRS,
         "Alcoholic" = ACEDRINK,
         "SubstanceAddiction" = ACEDRUGS,
         "Incarcerated" = ACEPRISN,
         "SeparationDivorce" = ACEDIVRC,
         "DomesticViolence" = ACEPUNCH,
         "PhysicalAbuse" = ACEHURT1,
         "EmotionalAbuse" = ACESWEAR,
         "SexualAbuse1" = ACETOUCH,
         "SexualAbuse2" = ACETTHEM,
         "SexualAbuse3" = ACEHVSEX) |>
  mutate(MentalIllness = case_when(
  MentalIllness == 1 ~ 1,
  MentalIllness == 2 ~ 0,
  MentalIllness == 7 ~ NA,
  MentalIllness == 9 ~ NA)) |>
  mutate(Alcoholic = case_when(
    Alcoholic == 1 ~ 1,
    Alcoholic == 2 ~ 0,
    Alcoholic == 7 ~ NA,
    Alcoholic == 9 ~ NA)) |> 
  mutate(SubstanceAddiction = case_when(
    SubstanceAddiction == 1 ~ 1,
    SubstanceAddiction == 2 ~ 0,
    SubstanceAddiction == 7 ~ NA,
    SubstanceAddiction == 9 ~ NA)) |>
  mutate(Incarcerated = case_when(
    Incarcerated == 1 ~ 1,
    Incarcerated == 2 ~ 0,
    Incarcerated == 7 ~ NA,
    Incarcerated == 9 ~ NA)) |> 
  mutate(SeparationDivorce = case_when(
    SeparationDivorce == 1 ~ 1,
    SeparationDivorce == 2 ~ 0,
    SeparationDivorce == 7 ~ NA,
    SeparationDivorce == 8 ~ NA,
    SeparationDivorce == 9 ~ NA)) |>
  mutate(DomesticViolence = case_when(
    DomesticViolence == 1 ~ 0,
    DomesticViolence == 2 ~ 1, 
    DomesticViolence == 3 ~ 1,
    DomesticViolence == 7 ~ NA,
    DomesticViolence == 9 ~ NA)) |>
  mutate(PhysicalAbuse = case_when(
    PhysicalAbuse == 1 ~ 0,
    PhysicalAbuse == 2 ~ 1,
    PhysicalAbuse == 3 ~ 1,
    PhysicalAbuse == 7 ~ NA,
    PhysicalAbuse == 9 ~ NA)) |>
  mutate(EmotionalAbuse = case_when(
    EmotionalAbuse == 1 ~ 0,
    EmotionalAbuse == 2 ~ 1, 
    EmotionalAbuse == 3 ~ 1,
    EmotionalAbuse == 7 ~ NA,
    EmotionalAbuse == 9 ~ NA)) |>
  mutate(SexualAbuse1 = case_when(
    SexualAbuse1 == 1 ~ 0,
    SexualAbuse1 == 2 ~ 1,
    SexualAbuse1 == 3 ~ 1,
    SexualAbuse1 == 7 ~ NA,
    SexualAbuse1 == 9 ~ NA)) |>
  mutate(SexualAbuse2 = case_when(
    SexualAbuse2 == 1 ~ 0,
    SexualAbuse2 == 2 ~ 1,
    SexualAbuse2 == 3 ~ 1,
    SexualAbuse2 == 7 ~ NA,
    SexualAbuse2 == 9 ~ NA)) |> 
  mutate(SexualAbuse3 = case_when(
    SexualAbuse3 == 1 ~ 0,
    SexualAbuse3 == 2 ~ 1,
    SexualAbuse3 == 3 ~ 1,
    SexualAbuse3 == 7 ~ NA,
    SexualAbuse3 == 9 ~ NA)) |>
  mutate(number = 3)

# 2019: 

twenty019 = twenty019 |> select(
                    IYEAR, '_STATE', SEXVAR, MARITAL, VETERAN3, INCOME2, WEIGHT2, HEIGHT3, 
                    EDUCA, RENTHOM1, EMPLOY1, CHILDREN, CAREGIV1, CRGVLNG1, CRGVPRB3, SOMALE, TRNSGNDR, "_METSTAT", "_URBSTAT", "_IMPRACE", "_AGE_G",
                    GENHLTH, PHYSHLTH, MENTHLTH, POORHLTH, EXERANY2, CVDINFR4, CVDCRHD4, CVDSTRK3, ASTHMA3, ADDEPEV3, CHCKDNY2, DIABETE4, DEAF, BLIND, DIFFWALK, DIFFDRES, DIFFALON,
                    SMOKE100, SMOKDAY2, USENOW3, LCSFIRST, LCSLAST, LCSNUMCG, ALCDAY5, AVEDRNK3, DRNK3GE5, MAXDRNKS, MARIJAN1, LASTSMK2, 
                    HLTHCVR1,
                    ACEDEPRS, ACEDRINK, ACEDRUGS, ACEPRISN, 
                    ACEDIVRC, ACEPUNCH, ACEHURT1, ACESWEAR,
                    ACETOUCH, ACETTHEM, ACEHVSEX) |> 
  filter(!is.na(ACEDEPRS) | !is.na(ACEDRINK) | !is.na(ACEDRUGS) | !is.na(ACEPRISN) | 
           !is.na(ACEDIVRC) | !is.na(ACEPUNCH) | !is.na(ACEHURT1) | !is.na(ACESWEAR) | 
           !is.na(ACETOUCH) | !is.na(ACETTHEM) | !is.na(ACEHVSEX)) |>
  rename("state" = "_STATE",
         "age" = "_AGE_G",
         "race" = "_IMPRACE",
         "sex" = SEXVAR,
        "MentalIllness" = ACEDEPRS,
         "Alcoholic" = ACEDRINK,
         "SubstanceAddiction" = ACEDRUGS,
         "Incarcerated" = ACEPRISN,
         "SeparationDivorce" = ACEDIVRC,
         "DomesticViolence" = ACEPUNCH,
         "PhysicalAbuse" = ACEHURT1,
         "EmotionalAbuse" = ACESWEAR,
         "SexualAbuse1" = ACETOUCH,
         "SexualAbuse2" = ACETTHEM,
         "SexualAbuse3" = ACEHVSEX) |>
  mutate(MentalIllness = case_when(
  MentalIllness == 1 ~ 1,
  MentalIllness == 2 ~ 0,
  MentalIllness == 7 ~ NA,
  MentalIllness == 9 ~ NA)) |>
  mutate(Alcoholic = case_when(
    Alcoholic == 1 ~ 1,
    Alcoholic == 2 ~ 0,
    Alcoholic == 7 ~ NA,
    Alcoholic == 9 ~ NA)) |> 
  mutate(SubstanceAddiction = case_when(
    SubstanceAddiction == 1 ~ 1,
    SubstanceAddiction == 2 ~ 0,
    SubstanceAddiction == 7 ~ NA,
    SubstanceAddiction == 9 ~ NA)) |>
  mutate(Incarcerated = case_when(
    Incarcerated == 1 ~ 1,
    Incarcerated == 2 ~ 0,
    Incarcerated == 7 ~ NA,
    Incarcerated == 9 ~ NA)) |> 
  mutate(SeparationDivorce = case_when(
    SeparationDivorce == 1 ~ 1,
    SeparationDivorce == 2 ~ 0,
    SeparationDivorce == 7 ~ NA,
    SeparationDivorce == 8 ~ NA,
    SeparationDivorce == 9 ~ NA)) |>
  mutate(DomesticViolence = case_when(
    DomesticViolence == 1 ~ 0,
    DomesticViolence == 2 ~ 1, 
    DomesticViolence == 3 ~ 1,
    DomesticViolence == 7 ~ NA,
    DomesticViolence == 9 ~ NA)) |>
  mutate(PhysicalAbuse = case_when(
    PhysicalAbuse == 1 ~ 0,
    PhysicalAbuse == 2 ~ 1,
    PhysicalAbuse == 3 ~ 1,
    PhysicalAbuse == 7 ~ NA,
    PhysicalAbuse == 9 ~ NA)) |>
  mutate(EmotionalAbuse = case_when(
    EmotionalAbuse == 1 ~ 0,
    EmotionalAbuse == 2 ~ 1, 
    EmotionalAbuse == 3 ~ 1,
    EmotionalAbuse == 7 ~ NA,
    EmotionalAbuse == 9 ~ NA)) |>
  mutate(SexualAbuse1 = case_when(
    SexualAbuse1 == 1 ~ 0,
    SexualAbuse1 == 2 ~ 1,
    SexualAbuse1 == 3 ~ 1,
    SexualAbuse1 == 7 ~ NA,
    SexualAbuse1 == 9 ~ NA)) |>
  mutate(SexualAbuse2 = case_when(
    SexualAbuse2 == 1 ~ 0,
    SexualAbuse2 == 2 ~ 1,
    SexualAbuse2 == 3 ~ 1,
    SexualAbuse2 == 7 ~ NA,
    SexualAbuse2 == 9 ~ NA)) |> 
  mutate(SexualAbuse3 = case_when(
    SexualAbuse3 == 1 ~ 0,
    SexualAbuse3 == 2 ~ 1,
    SexualAbuse3 == 3 ~ 1,
    SexualAbuse3 == 7 ~ NA,
    SexualAbuse3 == 9 ~ NA)) |>
  mutate(number = 4)

## Dataset that inclueds everything: 
everything = full_join(twenty019, full_join(twenty020, full_join(twenty021, twenty022)))

```


## Data Population  
It is important to understand the demographics of those who make up our data set in order to generalize the findings to a larger population. To do this we will look at data collected by year, state, age, sex, and race.  


### Surveys by Year  

The complete data set consists of 343,813 observations between 2019 and 2023. The year 2020 made up the largest proportion of observations ($p$ = 0.3795) followed by 2019 ($p$ = 0.2984), 2021 ($p$ = 0.1711), 2022 ($p$ = 0.1466), and, lastly 2023 ($p$ = 0.0044).  


```{r}
everything |> mutate(IYEAR = as.factor(IYEAR)) |>
  group_by(IYEAR) |>
  summarise(n_Surveys = n(),
            prop = n()/343813) |>
  rename("year" = IYEAR) |>
  kable()


year = everything |> mutate(IYEAR = as.factor(IYEAR)) |>
  group_by(IYEAR, sex) |>
  summarise(Surveys = n(),
            prop = n()/343813) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  ggplot(aes(x = IYEAR, y = prop, label = Surveys, fill = sex)) +
  geom_col() +
  coord_flip() +
  labs(y = "Proportion of Surveys", x = "Year") +
  theme_minimal() +
  scale_fill_brewer(palette = "Pastel1", direction = -1) +
  theme(
    axis.title = element_text(color = "black", family = "Avenir", size = 22),
    axis.text = element_text(color = "black", family = "Avenir", size = 18),
    legend.title = element_text(color = "white"),
    legend.text = element_text(color = "black", size = 13, family = "Avenir"),
    legend.position = "top"
  )
ggplotly(year, tooltip = "label")
```

## Surveys by State  


```{r}
library(maps)
library(ggmaps)
state_df <- ggplot2::map_data("state")
ggplot2::map_data()

maps::usa()

states = tibble(state.name = state.name) |> mutate(number = c(1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49, 50, 51, 53, 54, 55, 56))
otherstates = tibble(state.name = c("District of Columbia", "Guam", "Puerto Rico", "Virgin Islands"),
       number = c(11, 66, 72, 78))
states = full_join(states, otherstates)

ace_state = left_join(everything, states, by = c("state" = "number")) 
ace_state = ace_state |> group_by(state.name) |> 
  summarise(n = n()) |>
  mutate(state.name = str_to_lower(state.name)) |>
  rename("state" = "state.name", 
         "Surveys" = n)


 states = plot_usmap(data = ace_state, values = "Surveys") +
  theme_void() +
  scale_fill_distiller(palette = "PuRd", direction = 1, na.value = "black") + 
  labs(caption = "States that are black represent NA.", title = "Surveys by State") +
  theme(
    legend.text = element_text(color = "black", family = "Avenir", size = 15),
    legend.title = element_blank(),
    legend.key.width = unit(3, "line"),
    title = element_text(color = "black", family = "Avenir", size = 10),
    legend.position = c(0.55, 0.98),
    legend.direction = "horizontal",
    plot.title = element_text(color = "black", family = "Avenir", size = 16),
    plot.caption = element_text(color = "black", family = "Avenir", size = 11))

 
ggplotly(states)
```

## Surveys by Race  


```{r}

everything |>
  mutate(race = case_when(
    race == 1 ~ "White",
    race == 2 ~ "Black",
    race == 3 ~ "Asian",
    race == 4 ~ "AI/AN",
    race == 5 ~ "Hispanic",
    race == 6 ~ "Other"
  )) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  group_by(race, sex) |>
  summarise(Surveys = n(),
            prop = n()/343813) |>
  mutate(race = as.factor(race)) |>
  mutate(race = fct_relevel(race, c("Asian", "AI/AN", "Other", "Hispanic", "Black", "White"))) |>
  ggplot(aes(x = prop, y = race, fill = sex)) +
  geom_col() +
  theme_minimal() +
  labs(x = "Proportion", caption = "AI/AN = American Indian/Alaskan Native") +
  scale_fill_brewer(palette = "Pastel1", direction = -1) +
  theme(
    axis.title.y = element_blank(),
    axis.title.x = element_text(color = "black", size = 22, family = "Avenir"),
    axis.text.x = element_text(color = "black", size = 18, family = "Avenir"),
    axis.text.y = element_text(color = "black", size = 14, family = "Avenir"),
    legend.position = "top",
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    plot.caption = element_text(color = "black", size = 10, family = "Avenir")
  )


```



```{r}
everything |> 
  mutate(age = case_when(
    age == 1 ~ "18 to 24",
    age == 2 ~ "25 to 34",
    age == 3 ~ "35 to 44",
    age == 4 ~ "45 to 54",
    age == 5 ~ "55 to 64",
    age == 6 ~ "65 or > 65"
  )) |> 
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  group_by(age, sex) |>
  summarise(Surveys = n(),
            prop = n()/343813) |>
  ggplot(aes(x = prop, y = age, fill = sex)) +
  geom_col() +
  theme_minimal() +
  labs(x = "Proportion") +
  scale_fill_brewer(palette = "Pastel1", direction = -1) +
  theme(
    axis.title.y = element_blank(),
    axis.title.x = element_text(color = "black", size = 22, family = "Avenir"),
    axis.text.x = element_text(color = "black", size = 18, family = "Avenir"),
    axis.text.y = element_text(color = "black", size = 14, family = "Avenir"),
    legend.position = "top",
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    plot.caption = element_text(color = "black", size = 10, family = "Avenir")
  )
```


## Proportion with a History of Adverse Childhood Event Experience(s)  


```{r}
everything |> select(MentalIllness, Alcoholic, Incarcerated, SeparationDivorce, DomesticViolence, PhysicalAbuse, EmotionalAbuse, SexualAbuse1, SexualAbuse2, SexualAbuse3, Neglect1, Neglect2, SubstanceAddiction) |>
  summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE)/343813,
            Alcoholic = sum(Alcoholic, na.rm = TRUE)/343813,
            SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE)/343813,
            Incarcerated = sum(Incarcerated, na.rm = TRUE)/343813,
            SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE)/343813,
            DomesticViolence = sum(DomesticViolence, na.rm = TRUE)/343813,
            PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE)/343813,
            EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE)/343813,
            SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE)/343813,
            SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE)/343813,
            SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE)/343813,
            Neglect1 = sum(Neglect1, na.rm = TRUE)/104253,
            Neglect2 = sum(Neglect2, na.rm = TRUE)/104253) |>
  pivot_longer(c(1:13), names_to = "Category", values_to = "n") |>
  mutate(Category = fct_reorder(Category, n)) |>
  ggplot(aes(x = n, y = Category)) + 
  geom_col()
  

everything |> select(MentalIllness, Alcoholic, Incarcerated, SeparationDivorce, DomesticViolence, PhysicalAbuse, EmotionalAbuse, SexualAbuse1, SexualAbuse2, SexualAbuse3, Neglect1, Neglect2, SubstanceAddiction, sex) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  group_by(sex) |>
  summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE)/343813,
            Alcoholic = sum(Alcoholic, na.rm = TRUE)/343813,
            SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE)/343813,
            Incarcerated = sum(Incarcerated, na.rm = TRUE)/343813,
            SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE)/343813,
            DomesticViolence = sum(DomesticViolence, na.rm = TRUE)/343813,
            PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE)/343813,
            EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE)/343813,
            SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE)/343813,
            SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE)/343813,
            SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE)/343813,
            Neglect1 = sum(Neglect1, na.rm = TRUE)/104253,
            Neglect2 = sum(Neglect2, na.rm = TRUE)/104253) |>
  pivot_longer(c(2:14), names_to = "Category", values_to = "prop") |>
  mutate(Category = fct_reorder(Category, prop)) |>
  ggplot(aes(x = prop, y = Category, fill = sex)) + 
  scale_fill_brewer(palette = "Pastel1", direction = -1) +
  geom_col(position = position_dodge(0.9)) +
  theme_minimal() +
  labs(x = "Proportion of People") +
  theme(
    legend.position = "top",
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 14, family = "Avenir"),
    axis.title.y = element_blank(),
    axis.title.x = element_text(color = "black", size = 18, family = "Avenir"),
    axis.text.x = element_text(color = "black", size = 15, family = "Avenir"),
    axis.text.y = element_text(color = "black", size = 15, family = "Avenir"),
  )





everything |> 
  select(Neglect1, Neglect2) |> 
  filter(!is.na(Neglect1) | !is.na(Neglect2))


everything |> 
  mutate(age = case_when(
    age == 1 ~ "18 to 24",
    age == 2 ~ "25 to 34",
    age == 3 ~ "35 to 44",
    age == 4 ~ "45 to 54",
    age == 5 ~ "55 to 64",
    age == 6 ~ "65 or > 65"
  )) |> 
  mutate(race = case_when(
    race == 1 ~ "White",
    race == 2 ~ "Black",
    race == 3 ~ "Asian",
    race == 4 ~ "AI/AN",
    race == 5 ~ "Hispanic",
    race == 6 ~ "Other"
  )) |>
  mutate(sex = if_else(sex == 1, "Male", "Female")) |>
  group_by(age, sex) |>
            summarise(MentalIllness = sum(MentalIllness, na.rm = TRUE),
            Alcoholic = sum(Alcoholic, na.rm = TRUE),
            SubstanceAddiction = sum(SubstanceAddiction, na.rm = TRUE),
            Incarcerated = sum(Incarcerated, na.rm = TRUE),
            SeparationDivorce = sum(SeparationDivorce, na.rm = TRUE),
            DomesticViolence = sum(DomesticViolence, na.rm = TRUE),
            PhysicalAbuse = sum(PhysicalAbuse, na.rm = TRUE),
            EmotionalAbuse = sum(EmotionalAbuse, na.rm = TRUE),
            SexualAbuse1 = sum(SexualAbuse1, na.rm = TRUE),
            SexualAbuse2 = sum(SexualAbuse2, na.rm = TRUE),
            SexualAbuse3 = sum(SexualAbuse3, na.rm = TRUE),
            Neglect1 = sum(Neglect1, na.rm = TRUE),
            Neglect2 = sum(Neglect2, na.rm = TRUE)) |>
  pivot_longer(c(3:15), names_to = "Category", values_to = "n") |>
  ggplot(aes(x = n, y = age, fill = sex)) +
  geom_col(position = position_dodge(0.9)) +
  facet_wrap(~Category, ncol = 4) +
  theme_minimal() +
  scale_fill_brewer(palette = "Pastel1", direction = -1) +
  labs(x = "Number of People") +
  theme(
    axis.title.y = element_blank(),
    axis.title.x = element_text(color = "black", size = 22, family = "Avenir"),
    axis.text.x = element_text(color = "black", size = 10, family = "Avenir"),
    axis.text.y = element_text(color = "black", size = 14, family = "Avenir"),
    legend.position = "top",
    legend.title = element_blank(),
    legend.text = element_text(color = "black", size = 12, family = "Avenir"),
    plot.caption = element_text(color = "black", size = 10, family = "Avenir"),
    strip.text = element_text(color = "black", size = 12, family = "Avenir")
    
  ) 
```


# Addiction and ACEs  


## Have you smoked at least 100 cigarettes in your entire life?  

### Prior Information:  
This question was answered by 99.37% of the previously established population.   


```{=tex}

```


$$log(\frac{1-p}{p}) = \beta_1 (\text{MentalIllness}) + \beta_2 (\text{MentalIllness} \cdot \text{age}) + \beta_3 (\text{MentalIllness} \cdot \text{sex}) + \beta_4 (\text{MentalIllness} \cdot \text{age} \cdot \text{sex}) + \\
\beta_5 (\text{Alcohol}) + \beta_6 (\text{Alcohol} \cdot \text{age}) + \beta_7 (\text{Alcohol} \cdot \text{sex}) + \beta_8 (\text{Alcohol} \cdot \text{age} \cdot \text{sex}) + \\
\beta_9 (\text{Incarcerated}) + \beta_{10} (\text{Incarcerated} \cdot \text{age}) + \beta_{11} (\text{Incarcerated} \cdot \text{sex}) + \beta_{12} (\text{Incarcerated} \cdot \text{age} \cdot \text{sex}) + \\
\beta_{13} (\text{SeparationDivorce}) + \beta_{14} (\text{SeparationDivorce} \cdot \text{age}) + \beta_{15} (\text{SeparationDivorce} \cdot \text{sex}) + \beta_{16} (\text{SeparationDivorce} \cdot \text{age} \cdot \text{sex}) + \\
\beta_{17} (\text{DomesticViolence}) + \beta_{18} (\text{DomesticViolence} \cdot \text{age}) + \beta_{19} (\text{DomesticViolence} \cdot \text{sex}) + \beta_{20} (\text{DomesticViolence} \cdot \text{age} \cdot \text{sex}) + \\$$

```{r}
smoke100 = everything |> select(MentalIllness, Alcoholic, Incarcerated, SeparationDivorce, DomesticViolence, PhysicalAbuse, EmotionalAbuse, SexualAbuse1, SexualAbuse2, SexualAbuse3, Neglect1, Neglect2, SubstanceAddiction, SMOKE100, sex, age, race) |>
  mutate(SMOKE100 = case_when(
    SMOKE100 == 1 ~ 1,
    SMOKE100 == 2 ~ 0,
    SMOKE100 == 7 ~ NA,
    SMOKE100 == 9 ~ NA))

smoke100 = smoke100 |> filter(!is.na(SMOKE100))


smoke100all4 = glm(SMOKE100 ~
                    MentalIllness + MentalIllness*sex + MentalIllness*age + MentalIllness*age*sex + 
                    Alcoholic + Alcoholic*sex + Alcoholic*age + Alcoholic*age*sex + 
                    SubstanceAddiction + SubstanceAddiction*sex + SubstanceAddiction*age + SubstanceAddiction*age*sex + 
                    Incarcerated + Incarcerated*sex + Incarcerated*age + Incarcerated*age*sex + 
                    SeparationDivorce + SeparationDivorce*sex + SeparationDivorce*age + SeparationDivorce*age*sex + 
                    DomesticViolence + DomesticViolence*sex + DomesticViolence*age + DomesticViolence*age*sex + 
                    PhysicalAbuse + PhysicalAbuse*sex  + PhysicalAbuse*age + PhysicalAbuse*age*sex + 
                    EmotionalAbuse + EmotionalAbuse*sex + EmotionalAbuse*age + EmotionalAbuse*age*sex + 
                    SexualAbuse1 + SexualAbuse1*sex + SexualAbuse1*age + SexualAbuse1*age*sex + 
                    SexualAbuse2 + SexualAbuse2*sex + SexualAbuse2*age + SexualAbuse2*age*sex + 
                    SexualAbuse3 + SexualAbuse3*sex + SexualAbuse3*age + SexualAbuse3*age*sex + 
                    Neglect1 + Neglect1*sex + Neglect1*age + Neglect1*age*sex + 
                    Neglect2 + Neglect2*sex + Neglect2*age + Neglect2*age*sex, 
                  family = "quasibinomial", data = smoke100)
summary(smoke100all4)
exp(smoke100all4$coefficients)

```





























































state_df = data.frame(state.center, state=state.name)

left_join(state_df, ace_state) |> ggplot(aes(x = x, y = y)) +
  geom_polygon()



ggplot2::map_data("usa")

state_df |> distinct(region)



```{r}
library(rnaturalearth)
library(rnaturalearthdata)
library(sf)

state_df <- ggplot2::map_data("state")

states = tibble(state.name = state.name) |> mutate(number = c(1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49, 50, 51, 53, 54, 55, 56))
otherstates = tibble(state.name = c("District of Columbia", "Guam", "Puerto Rico", "Virgin Islands"),
       number = c(11, 66, 72, 78))
states = full_join(states, otherstates)

ace_state = left_join(everything, states, by = c("state" = "number")) 
ace_state = ace_state |> group_by(state.name) |> 
  summarise(n = n()) |>
  mutate(state.name = str_to_lower(state.name)) |>
  rename("state" = "state.name", 
         "values" = n) |>
  mutate(state = str_to_title(state))



data = rnaturalearthdata::states50
class(data)

data = data |> filter(admin == "United States of America") 

data = left_join(data, ace_state, by = c("name" = "state"))

data |> 
  ggplot() +
  geom_polygon(aes(x = geometry))

(mainland = data |> 
  ggplot(fill = values, col = values) +
  theme_void() +
  scale_fill_distiller(palette = "PuRd", direction = 1, na.value = "black") +
  geom_sf() +
     coord_sf(crs = st_crs(2163), xlim = c(-2500000, 2500000), ylim = c(-2300000, 
         730000)))

(alaska <- ggplot(data = data) +
     geom_sf() +
     coord_sf(crs = st_crs(3467), xlim = c(-2400000, 1600000), ylim = c(200000, 
         2500000), expand = FALSE, datum = NA))


(hawaii  <- ggplot(data = data) +
     geom_sf() +
     coord_sf(crs = st_crs(4135), xlim = c(-161, -154), ylim = c(18, 
         23), expand = FALSE, datum = NA))


mainland +
 annotation_custom(
      grob = ggplotGrob(alaska),
      xmin = -2750000,
      xmax = -2750000 + (1600000 - (-2400000))/2.5,
      ymin = -2450000,
      ymax = -2450000 + (2500000 - 200000)/2.5
  ) +
  annotation_custom(
      grob = ggplotGrob(hawaii),
      xmin = -1250000,
      xmax = -1250000 + (-154 - (-161))*120000,
      ymin = -2450000,
      ymax = -2450000 + (23 - 18)*120000
  ) 



  



  
```












